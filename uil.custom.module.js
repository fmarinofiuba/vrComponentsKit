/**
 * @license
 * Copyright 2010-2021 Uil.js Authors
 * SPDX-License-Identifier: MIT
 */const n={ui:[],dom:null,ID:null,lock:!1,wlock:!1,current:-1,needReZone:!0,needResize:!1,forceZone:!1,isEventsInit:!1,isLeave:!1,addDOMEventListeners:!1,downTime:0,prevTime:0,prevDefault:["contextmenu"],pointerEvent:["pointerdown","pointermove","pointerup"],eventOut:["pointercancel","pointerout","pointerleave"],xmlserializer:null,tmpTime:null,tmpImage:null,oldCursor:"auto",input:null,parent:null,firstImput:!0,hiddenImput:null,hiddenSizer:null,hasFocus:!1,startInput:!1,inputRange:[0,0],cursorId:0,str:"",pos:0,startX:-1,moveX:-1,debugInput:!1,isLoop:!1,listens:[],e:{type:null,clientX:0,clientY:0,keyCode:NaN,key:null,delta:0},isMobile:!1,now:null,getTime:function(){return self.performance&&self.performance.now?self.performance.now.bind(performance):Date.now},add:function(e){n.ui.push(e),n.getZone(e),n.isEventsInit||n.initEvents()},testMobile:function(){let e=navigator.userAgent;return!!(e.match(/Android/i)||e.match(/webOS/i)||e.match(/iPhone/i)||e.match(/iPad/i)||e.match(/iPod/i)||e.match(/BlackBerry/i)||e.match(/Windows Phone/i))},remove:function(e){let t=n.ui.indexOf(e);t!==-1&&(n.removeListen(e),n.ui.splice(t,1)),n.ui.length===0&&n.removeEvents()},initEvents:function(){if(n.isEventsInit)return;let e=document.body;n.isMobile=n.testMobile(),n.now=n.getTime(),n.isMobile?e.style.touchAction="none":e.addEventListener("wheel",n,{passive:!1}),n.addDOMEventListeners&&(e.addEventListener("pointercancel",n),e.addEventListener("pointerleave",n),e.addEventListener("pointermove",n),e.addEventListener("pointerdown",n),e.addEventListener("pointerup",n),e.addEventListener("keydown",n,!1),e.addEventListener("keyup",n,!1)),window.addEventListener("resize",n.resize,!1),n.isEventsInit=!0,n.dom=e},removeEvents:function(){if(!n.isEventsInit)return;let e=document.body;n.isMobile||e.removeEventListener("wheel",n),e.removeEventListener("pointercancel",n),e.removeEventListener("pointerleave",n),e.removeEventListener("pointermove",n),e.removeEventListener("pointerdown",n),e.removeEventListener("pointerup",n),e.removeEventListener("keydown",n),e.removeEventListener("keyup",n),window.removeEventListener("resize",n.resize),n.isEventsInit=!1},resize:function(){let e,t=n.ui.length;for(;t--;)e=n.ui[t],e.isGui&&!e.isCanvasOnly&&e.autoResize&&e.calc();n.needReZone=!0,n.needResize=!1},out:function(){console.log("im am out"),n.clearOldID()},in:function(){console.log("im am in")},fakeUp:function(){this.handleEvent({type:"pointerup"})},handleEvent:function(e){n.prevDefault.indexOf(e.type)!==-1&&e.preventDefault(),n.needResize&&n.resize(),n.findZone(n.forceZone);let t=n.e,s=!1;e.type==="keydown"&&n.keydown(e),e.type==="keyup"&&n.keyup(e),e.type==="wheel"?t.delta=e.deltaY>0?1:-1:t.delta=0;let i=e.pointerType;if(t.clientX=(i==="touch"?e.pageX:e.clientX)||0,t.clientY=(i==="touch"?e.pageY:e.clientY)||0,t.type=e.type,n.eventOut.indexOf(e.type)!==-1&&(s=!0,t.type="mouseup"),e.type==="pointerleave"&&(n.isLeave=!0),e.type==="pointerdown"&&(t.type="mousedown"),e.type==="pointerup"&&(t.type="mouseup"),e.type==="pointermove"&&(n.isLeave&&(n.isLeave=!1,n.resize()),t.type="mousemove"),t.type==="mousedown"){if(n.downTime=n.now(),n.downTime-n.prevTime<200)return n.selectAll(),!1;n.prevTime=n.downTime,n.forceZone=!1}t.type==="mousedown"&&n.clearInput(),t.type==="mousedown"&&(n.lock=!0),t.type==="mouseup"&&(n.lock=!1),n.isMobile&&t.type==="mousedown"&&n.findID(t),t.type!=="mousemove"||n.lock||n.findID(t),n.ID!==null&&(n.ID.isCanvasOnly&&(t.clientX=n.ID.mouse.x,t.clientY=n.ID.mouse.y),n.ID.handleEvent(t)),n.isMobile&&t.type==="mouseup"&&n.clearOldID(),s&&n.clearOldID()},findID:function(e){let t,s,i,h=n.ui.length,o=-1;for(;h--;)if(t=n.ui[h],t.isCanvasOnly?(s=t.mouse.x,i=t.mouse.y):(s=e.clientX,i=e.clientY),n.onZone(t,s,i)){o=h,o!==n.current&&(n.clearOldID(),n.current=o,n.ID=t);break}o===-1&&n.clearOldID()},clearOldID:function(){n.ID&&(n.current=-1,n.ID.reset(),n.ID=null,n.cursor())},calcUis:(e,t,s,i=!1)=>{let h,o,r,c=e.length,d=0,m=0,g=0;for(;c--;)h=e[m],m++,!i&&h.isGroup&&h.calcUis(),r=h.margin,h.zone.w=h.w,h.zone.h=h.h+r,h.autoWidth?(d=0,h.zone.x=t.x+h.dx,h.zone.y=s,s+=h.h+r,g+=h.h+r):(d===0&&(g+=h.h+r),h.zone.x=t.x+d,h.zone.y=s,o=n.getWidth(h),o?h.zone.w=h.w=o:h.fw&&(h.zone.w=h.w=h.fw),d+=h.zone.w,d>=t.w&&(s+=h.h+r,d=0));return g},findTarget:function(e,t){let s=e.length;for(;s--;)if(n.onZone(e[s],t.clientX,t.clientY))return s;return-1},findZone:function(e){if(n.needReZone||e){for(var t,s=n.ui.length;s--;)t=n.ui[s],n.getZone(t),t.isGui&&t.calcUis();n.needReZone=!1}},onZone:function(e,t,s){if(t===void 0||s===void 0)return!1;let i=e.zone,h=t-i.x,o=s-i.y,r=h>=0&&o>=0&&h<=i.w&&o<=i.h;return r?e.local.set(h,o):e.local.neg(),r},getWidth:function(e){return e.getDom().clientWidth},getZone:function(e){if(e.isCanvasOnly)return;let t=e.getDom().getBoundingClientRect();e.zone={x:t.left,y:t.top,w:t.width,h:t.height}},cursor:function(e){(e=e||"auto")!==n.oldCursor&&(document.body.style.cursor=e,n.oldCursor=e)},toCanvas:function(e,t,s,i){if(n.xmlserializer||(n.xmlserializer=new XMLSerializer),i&&n.tmpTime!==null&&(clearTimeout(n.tmpTime),n.tmpTime=null),n.tmpTime!==null)return;n.lock&&(n.tmpTime=setTimeout(function(){n.tmpTime=null},10));let h=!1;t===e.canvas.width&&s===e.canvas.height||(h=!0),n.tmpImage===null&&(n.tmpImage=new Image);let o=n.tmpImage,r=n.xmlserializer.serializeToString(e.content),c='<svg xmlns="http://www.w3.org/2000/svg" width="'+t+'" height="'+s+'"><foreignObject style="pointer-events: none; left:0;" width="100%" height="100%">'+r+"</foreignObject></svg>";o.onload=function(){let d=e.canvas.getContext("2d");h?(e.canvas.width=t,e.canvas.height=s):d.clearRect(0,0,t,s),d.drawImage(this,0,0),e.onDraw()},o.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(c),o.crossOrigin=""},setHidden:function(){n.hiddenImput===null&&(n.hiddenImput=document.createElement("input"),n.hiddenImput.type="text",n.hiddenSizer=document.createElement("div"),document.body.appendChild(n.hiddenImput),document.body.appendChild(n.hiddenSizer));let e=n.debugInput?"":"opacity:0; zIndex:0;",t=n.parent.css.txtselect+"padding:0; width:auto; height:auto; left:10px; top:auto; color:#FFF; background:#000;"+e;n.hiddenImput.style.cssText=t+"bottom:10px;"+(n.debugInput?"":"transform:scale(0);"),n.hiddenSizer.style.cssText=t+"bottom:40px;",n.hiddenImput.style.width=n.input.clientWidth+"px",n.hiddenImput.value=n.str,n.hiddenSizer.innerHTML=n.str,n.hasFocus=!0},clearHidden:function(e){n.hiddenImput!==null&&(n.hasFocus=!1)},clickPos:function(e){let t=n.str.length,s=0,i=0;for(;t--&&(s+=n.textWidth(n.str[i]),!(s>=e));)i++;return i},upInput:function(e,t){if(n.parent===null)return!1;let s=!1;if(t){let i=n.clickPos(e);n.moveX=i,n.startX===-1?(n.startX=i,n.cursorId=i,n.inputRange=[n.startX,n.startX]):n.moveX!==n.startX&&(n.startX>n.moveX?n.inputRange=[n.moveX,n.startX]:n.inputRange=[n.startX,n.moveX]),s=!0}else n.startX!==-1&&(n.hasFocus=!0,n.hiddenImput.focus(),n.hiddenImput.selectionStart=n.inputRange[0],n.hiddenImput.selectionEnd=n.inputRange[1],n.startX=-1,s=!0);return s&&n.selectParent(),s},selectAll:function(){n.parent&&(n.str=n.input.textContent,n.inputRange=[0,n.str.length],n.hasFocus=!0,n.hiddenImput.focus(),n.hiddenImput.selectionStart=n.inputRange[0],n.hiddenImput.selectionEnd=n.inputRange[1],n.cursorId=n.inputRange[1],n.selectParent())},selectParent:function(){var e=n.textWidth(n.str.substring(0,n.cursorId)),t=n.textWidth(n.str.substring(0,n.inputRange[0])),s=n.textWidth(n.str.substring(n.inputRange[0],n.inputRange[1]));n.parent.select(e,t,s,n.hiddenSizer.innerHTML)},textWidth:function(e){return n.hiddenSizer===null?0:(e=e.replace(/ /g,"&nbsp;"),n.hiddenSizer.innerHTML=e,n.hiddenSizer.clientWidth)},clearInput:function(){n.parent!==null&&(n.firstImput||n.parent.validate(!0),n.clearHidden(),n.parent.unselect(),n.input.style.background=n.parent.colors.back,n.input.style.borderColor=n.parent.colors.border,n.parent.isEdit=!1,n.input=null,n.parent=null,n.str="",n.firstImput=!0)},setInput:function(e,t){n.clearInput(),n.input=e,n.parent=t,n.input.style.background=n.parent.colors.backoff,n.input.style.borderColor=n.parent.colors.select,n.str=n.input.textContent,n.setHidden()},keydown:function(e){if(n.parent===null)return;let t=e.which;e.shiftKey,n.firstImput=!1,n.hasFocus&&(window.focus(),n.hiddenImput.focus()),n.parent.isEdit=!0,t===13?n.clearInput():n.input.isNum?e.keyCode>47&&e.keyCode<58||e.keyCode>95&&e.keyCode<106||e.keyCode===190||e.keyCode===110||e.keyCode===8||e.keyCode===109?n.hiddenImput.readOnly=!1:n.hiddenImput.readOnly=!0:n.hiddenImput.readOnly=!1},keyup:function(e){n.parent!==null&&(n.str=n.hiddenImput.value,n.parent.allEqual?n.parent.sameStr(n.str):n.input.textContent=n.str,n.cursorId=n.hiddenImput.selectionStart,n.inputRange=[n.hiddenImput.selectionStart,n.hiddenImput.selectionEnd],n.selectParent(),n.parent.validate())},loop:function(){n.isLoop&&requestAnimationFrame(n.loop),n.update()},update:function(){let e=n.listens.length;for(;e--;)n.listens[e].listening()},removeListen:function(e){let t=n.listens.indexOf(e);t!==-1&&n.listens.splice(t,1),n.listens.length===0&&(n.isLoop=!1)},addListen:function(e){return n.listens.indexOf(e)===-1&&(n.listens.push(e),n.isLoop||(n.isLoop=!0,n.loop()),!0)}},u=n,l={transition:.2,frag:document.createDocumentFragment(),colorRing:null,joystick_0:null,joystick_1:null,circular:null,knob:null,pad2d:null,svgns:"http://www.w3.org/2000/svg",links:"http://www.w3.org/1999/xlink",htmls:"http://www.w3.org/1999/xhtml",DOM_SIZE:["height","width","top","left","bottom","right","margin-left","margin-right","margin-top","margin-bottom"],SVG_TYPE_D:["pattern","defs","transform","stop","animate","radialGradient","linearGradient","animateMotion","use","filter","feColorMatrix"],SVG_TYPE_G:["svg","rect","circle","path","polygon","text","g","line","foreignObject"],PI:Math.PI,TwoPI:2*Math.PI,pi90:.5*Math.PI,pi60:Math.PI/3,torad:Math.PI/180,todeg:180/Math.PI,clamp:(e,t,s)=>e=(e=e<t?t:e)>s?s:e,isDivid:e=>.5*e===Math.floor(.5*e),size:{w:240,h:20,p:30,s:8},defineColor:(e,t=l.colors)=>{let s={...t},i=["fontFamily","fontWeight","fontShadow","fontSize"],h=!1;e.font&&(e.fontFamily=e.font),e.shadow&&(e.fontShadow=e.shadow),e.weight&&(e.fontWeight=e.weight),e.fontColor&&(e.text=e.fontColor),e.color&&(e.text=e.color),e.text&&(s.text=e.text,e.fontColor||e.color||(s.title=l.ColorLuma(e.text,-.25),s.titleoff=l.ColorLuma(e.text,-.5)),s.textOver=l.ColorLuma(e.text,.25),s.textSelect=l.ColorLuma(e.text,.5)),e.button&&(s.button=e.button,s.border=l.ColorLuma(e.button,.1),s.overoff=l.ColorLuma(e.button,.2)),e.select&&(s.select=e.select,s.over=l.ColorLuma(e.select,-.1)),e.itemBg&&(e.back=e.itemBg),e.back&&(s.back=e.back,s.backoff=l.ColorLuma(e.back,-.1)),e.fontSelect&&(s.textSelect=e.fontSelect),e.groupBorder&&(s.gborder=e.groupBorder),e.bgOver&&(s.backgroundOver=e.bgOver);for(let o in s)e[o]!==void 0&&(s[o]=e[o]);for(let o in e)i.indexOf(o)!==-1&&(h=!0);return h&&l.defineText(s),s},colors:{sx:4,sy:2,radius:2,showOver:1,content:"none",background:"rgba(50,50,50,0.15)",backgroundOver:"rgba(50,50,50,0.3)",title:"#CCC",titleoff:"#BBB",text:"#DDD",textOver:"#EEE",textSelect:"#FFF",back:"rgba(0,0,0,0.2)",backoff:"rgba(0,0,0,0.3)",border:"#4c4c4c",borderSize:1,gborder:"none",groups:"none",button:"#3c3c3c",overoff:"#5c5c5c",over:"#024699",select:"#308AFF",action:"#FF3300",fontFamily:"Consolas, monospace",fontWeight:"normal",fontShadow:"none",fontSize:12,joyOver:"rgba(48,138,255,0.25)",joyOut:"rgba(100,100,100,0.5)",joySelect:"#308AFF",hide:"rgba(0,0,0,0)"},css:{basic:"position:absolute; pointer-events:none; box-sizing:border-box; margin:0; padding:0; overflow:hidden; -o-user-select:none; -ms-user-select:none; -khtml-user-select:none; -webkit-user-select:none; -moz-user-select:none;",button:"display:flex; align-items:center; justify-content:center; text-align:center;",middle:"display:flex; align-items:center; justify-content:left; text-align:left; flex-direction: row-reverse;"},svgs:{g1:"M 6 4 L 0 4 0 6 6 6 6 4 M 6 0 L 0 0 0 2 6 2 6 0 Z",g2:"M 6 0 L 4 0 4 6 6 6 6 0 M 2 0 L 0 0 0 6 2 6 2 0 Z",group:"M 7 7 L 7 8 8 8 8 7 7 7 M 5 7 L 5 8 6 8 6 7 5 7 M 3 7 L 3 8 4 8 4 7 3 7 M 7 5 L 7 6 8 6 8 5 7 5 M 6 6 L 6 5 5 5 5 6 6 6 M 7 3 L 7 4 8 4 8 3 7 3 M 6 4 L 6 3 5 3 5 4 6 4 M 3 5 L 3 6 4 6 4 5 3 5 M 3 3 L 3 4 4 4 4 3 3 3 Z",arrow:"M 3 8 L 8 5 3 2 3 8 Z",arrowDown:"M 5 8 L 8 3 2 3 5 8 Z",arrowUp:"M 5 2 L 2 7 8 7 5 2 Z",solid:"M 13 10 L 13 1 4 1 1 4 1 13 10 13 13 10 M 11 3 L 11 9 9 11 3 11 3 5 5 3 11 3 Z",body:"M 13 10 L 13 1 4 1 1 4 1 13 10 13 13 10 M 11 3 L 11 9 9 11 3 11 3 5 5 3 11 3 M 5 4 L 4 5 4 10 9 10 10 9 10 4 5 4 Z",vehicle:"M 13 6 L 11 1 3 1 1 6 1 13 3 13 3 11 11 11 11 13 13 13 13 6 M 2.4 6 L 4 2 10 2 11.6 6 2.4 6 M 12 8 L 12 10 10 10 10 8 12 8 M 4 8 L 4 10 2 10 2 8 4 8 Z",articulation:"M 13 9 L 12 9 9 2 9 1 5 1 5 2 2 9 1 9 1 13 5 13 5 9 4 9 6 5 8 5 10 9 9 9 9 13 13 13 13 9 Z",character:"M 13 4 L 12 3 9 4 5 4 2 3 1 4 5 6 5 8 4 13 6 13 7 9 8 13 10 13 9 8 9 6 13 4 M 6 1 L 6 3 8 3 8 1 6 1 Z",terrain:"M 13 8 L 12 7 Q 9.06 -3.67 5.95 4.85 4.04 3.27 2 7 L 1 8 7 13 13 8 M 3 8 Q 3.78 5.420 5.4 6.6 5.20 7.25 5 8 L 7 8 Q 8.39 -0.16 11 8 L 7 11 3 8 Z",joint:"M 7.7 7.7 Q 8 7.45 8 7 8 6.6 7.7 6.3 7.45 6 7 6 6.6 6 6.3 6.3 6 6.6 6 7 6 7.45 6.3 7.7 6.6 8 7 8 7.45 8 7.7 7.7 M 3.35 8.65 L 1 11 3 13 5.35 10.65 Q 6.1 11 7 11 8.28 11 9.25 10.25 L 7.8 8.8 Q 7.45 9 7 9 6.15 9 5.55 8.4 5 7.85 5 7 5 6.54 5.15 6.15 L 3.7 4.7 Q 3 5.712 3 7 3 7.9 3.35 8.65 M 10.25 9.25 Q 11 8.28 11 7 11 6.1 10.65 5.35 L 13 3 11 1 8.65 3.35 Q 7.9 3 7 3 5.7 3 4.7 3.7 L 6.15 5.15 Q 6.54 5 7 5 7.85 5 8.4 5.55 9 6.15 9 7 9 7.45 8.8 7.8 L 10.25 9.25 Z",ray:"M 9 11 L 5 11 5 12 9 12 9 11 M 12 5 L 11 5 11 9 12 9 12 5 M 11.5 10 Q 10.9 10 10.45 10.45 10 10.9 10 11.5 10 12.2 10.45 12.55 10.9 13 11.5 13 12.2 13 12.55 12.55 13 12.2 13 11.5 13 10.9 12.55 10.45 12.2 10 11.5 10 M 9 10 L 10 9 2 1 1 2 9 10 Z",collision:"M 11 12 L 13 10 10 7 13 4 11 2 7.5 5.5 9 7 7.5 8.5 11 12 M 3 2 L 1 4 4 7 1 10 3 12 8 7 3 2 Z",map:"M 13 1 L 1 1 1 13 13 13 13 1 M 12 2 L 12 7 7 7 7 12 2 12 2 7 7 7 7 2 12 2 Z",material:"M 13 1 L 1 1 1 13 13 13 13 1 M 12 2 L 12 7 7 7 7 12 2 12 2 7 7 7 7 2 12 2 Z",texture:"M 13 4 L 13 1 1 1 1 4 5 4 5 13 9 13 9 4 13 4 Z",object:"M 10 1 L 7 4 4 1 1 1 1 13 4 13 4 5 7 8 10 5 10 13 13 13 13 1 10 1 Z",none:"M 9 5 L 5 5 5 9 9 9 9 5 Z",cursor:"M 4 7 L 1 10 1 12 2 13 4 13 7 10 9 14 14 0 0 5 4 7 Z",load:"M 13 8 L 11.5 6.5 9 9 9 3 5 3 5 9 2.5 6.5 1 8 7 14 13 8 M 9 2 L 9 0 5 0 5 2 9 2 Z",save:"M 9 12 L 5 12 5 14 9 14 9 12 M 11.5 7.5 L 13 6 7 0 1 6 2.5 7.5 5 5 5 11 9 11 9 5 11.5 7.5 Z",extern:"M 14 14 L 14 0 0 0 0 14 14 14 M 12 6 L 12 12 2 12 2 6 12 6 M 12 2 L 12 4 2 4 2 2 12 2 Z"},rezone(){u.needReZone=!0},getImput:function(){return!!u.input},setStyle:function(e){for(var t in e)l.colors[t]&&(l.colors[t]=e[t]);l.setText()},defineText:function(e){l.setText(e.fontSize,e.text,e.fontFamily,e.fontShadow,e.fontWeight)},setText:function(e,t,s,i,h){let o=l.colors;s===void 0&&(s=o.fontFamily),e===void 0&&(e=o.fontSize),i===void 0&&(i=o.fontShadow),h===void 0&&(h=o.fontWeight),t===void 0&&(t=o.text),isNaN(e)?e.search("em")===-1&&(e+="px"):e+="px",l.css.txt=l.css.basic+l.css.middle+" font-family:"+s+"; font-weight:"+h+"; font-size:"+e+"; color:"+o.text+"; padding:0px 8px; left:0; top:2px; height:16px; width:100px; overflow:hidden; white-space: nowrap; letter-spacing: normal;",i!=="none"&&(l.css.txt+=" text-shadow: 1px 1px 1px "+i+";"),l.css.txtselect=l.css.txt+"padding:0px 4px; border:1px dashed "+o.border+";",l.css.item=l.css.txt+"padding:0px 4px; position:relative; margin-bottom:1px; "},cloneCss:function(){return{...l.css}},clone:function(e){return e.cloneNode(!0)},setSvg:function(e,t,s,i,h){i===-1?e.setAttributeNS(null,t,s):h!==void 0?e.childNodes[i||0].childNodes[h||0].setAttributeNS(null,t,s):e.childNodes[i||0].setAttributeNS(null,t,s)},setCss:function(e,t){for(let s in t)l.DOM_SIZE.indexOf(s)!==-1?e.style[s]=t[s]+"px":e.style[s]=t[s]},set:function(e,t){for(let s in t)s==="txt"&&(e.textContent=t[s]),s==="link"?e.setAttributeNS(l.links,"xlink:href",t[s]):e.setAttributeNS(null,s,t[s])},get:function(e,t){if(t===void 0)return e;if(!isNaN(t))return e.childNodes[t];if(t instanceof Array){if(t.length===2)return e.childNodes[t[0]].childNodes[t[1]];if(t.length===3)return e.childNodes[t[0]].childNodes[t[1]].childNodes[t[2]]}},dom:function(e,t,s,i,h){return e=e||"div",l.SVG_TYPE_D.indexOf(e)!==-1||l.SVG_TYPE_G.indexOf(e)!==-1?e==="svg"?(i=document.createElementNS(l.svgns,"svg"),l.set(i,s)):(i===void 0&&(i=document.createElementNS(l.svgns,"svg")),l.addAttributes(i,e,s,h)):i=i===void 0?document.createElementNS(l.htmls,e):i.appendChild(document.createElementNS(l.htmls,e)),t&&(i.style.cssText=t),h===void 0?i:i.childNodes[h||0]},addAttributes:function(e,t,s,i){let h=document.createElementNS(l.svgns,t);return l.set(h,s),l.get(e,i).appendChild(h),l.SVG_TYPE_G.indexOf(t)!==-1&&(h.style.pointerEvents="none"),h},clear:function(e){for(l.purge(e);e.firstChild;)e.firstChild.firstChild&&l.clear(e.firstChild),e.removeChild(e.firstChild)},purge:function(e){let t,s,i=e.attributes;if(i)for(t=i.length;t--;)s=i[t].name,typeof e[s]=="function"&&(e[s]=null);if(i=e.childNodes,i)for(t=i.length;t--;)l.purge(e.childNodes[t])},addSVGGlowEffect:function(){if(document.getElementById("UILGlow")!==null)return;let e=l.initUILEffects(),t=l.addAttributes(e,"filter",{id:"UILGlow",x:"-20%",y:"-20%",width:"140%",height:"140%"});l.addAttributes(t,"feGaussianBlur",{in:"SourceGraphic",stdDeviation:"3",result:"uilBlur"});let s=l.addAttributes(t,"feMerge",{});for(let i=0;i<=3;i++)l.addAttributes(s,"feMergeNode",{in:"uilBlur"});l.addAttributes(s,"feMergeNode",{in:"SourceGraphic"})},initUILEffects:function(){let e=document.getElementById("UILSVGEffects");return e===null&&(e=l.dom("svg",void 0,{id:"UILSVGEffects",width:"0",height:"0"}),document.body.appendChild(e)),e},ColorLuma:function(e,t){e==="n"&&(e="#000"),(e=String(e).replace(/[^0-9a-f]/gi,"")).length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),t=t||0;let s,i,h="#";for(i=0;i<3;i++)s=parseInt(e.substr(2*i,2),16),s=Math.round(Math.min(Math.max(0,s+s*t),255)).toString(16),h+=("00"+s).substr(s.length);return h},findDeepInver:function(e){return .3*e[0]+.59*e[1]+.11*e[2]<=.6},lerpColor:function(e,t,s){let i={};for(let h=0;h<3;h++)i[h]=e[h]+(t[h]-e[h])*s;return i},hexToHtml:function(e){return"#"+("000000"+(e=e===void 0?0:e).toString(16)).substr(-6)},htmlToHex:function(e){return e.toUpperCase().replace("#","0x")},u255:function(e,t){return parseInt(e.substring(t,t+2),16)/255},u16:function(e,t){return parseInt(e.substring(t,t+1),16)/15},unpack:function(e){return e.length==7?[l.u255(e,1),l.u255(e,3),l.u255(e,5)]:e.length==4?[l.u16(e,1),l.u16(e,2),l.u16(e,3)]:void 0},p255:function(e){let t=Math.round(255*e).toString(16);return t.length<2&&(t="0"+t),t},pack:function(e){return"#"+l.p255(e[0])+l.p255(e[1])+l.p255(e[2])},htmlRgb:function(e){return"rgb("+Math.round(255*e[0])+","+Math.round(255*e[1])+","+Math.round(255*e[2])+")"},pad:function(e){return e.length==1&&(e="0"+e),e},rgbToHex:function(e){let t=Math.round(255*e[0]).toString(16),s=Math.round(255*e[1]).toString(16),i=Math.round(255*e[2]).toString(16);return"#"+l.pad(t)+l.pad(s)+l.pad(i)},hueToRgb:function(e,t,s){return s<0&&(s+=1),s>1&&(s-=1),s<1/6?e+6*(t-e)*s:s<.5?t:s<2/3?e+6*(t-e)*(2/3-s):e},rgbToHsl:function(e){let t=e[0],s=e[1],i=e[2],h=Math.min(t,s,i),o=Math.max(t,s,i),r=o-h,c=0,d=0,m=(h+o)/2;return m>0&&m<1&&(d=r/(m<.5?2*m:2-2*m)),r>0&&(o==t&&o!=s&&(c+=(s-i)/r),o==s&&o!=i&&(c+=2+(i-t)/r),o==i&&o!=t&&(c+=4+(t-s)/r),c/=6),[c,d,m]},hslToRgb:function(e){let t,s,i=e[0],h=e[1],o=e[2];return h===0?[o,o,o]:(s=o<=.5?o*(h+1):o+h-o*h,t=2*o-s,[l.hueToRgb(t,s,i+.33333),l.hueToRgb(t,s,i),l.hueToRgb(t,s,i-.33333)])},makeGradiant:function(e,t,s,i){l.dom(e,null,t,s,0);let h,o=s.childNodes[0].childNodes.length-1;for(let r=0;r<i.length;r++)h=i[r],l.dom("stop",null,{offset:h[0]+"%","stop-color":h[1],"stop-opacity":h[2]},s,[0,o])},makePad:function(e){let t=256,s=l.dom("svg",l.css.basic+"position:relative;",{viewBox:"0 0 256 "+t,width:t,height:t,preserveAspectRatio:"none"}),i=200,h=28;a.dom("rect","",{x:h,y:h,width:i,height:i,fill:l.colors.back},s),a.dom("rect","",{x:38,y:38,width:180,height:180,fill:l.colors.button},s),a.dom("line","",{x1:38,y1:128,x2:218,y2:128,stroke:l.colors.back,"stroke-width":2},s),a.dom("line","",{x1:128,x2:128,y1:38,y2:218,stroke:l.colors.back,"stroke-width":2},s),a.dom("circle","",{cx:128,cy:128,r:5,stroke:l.colors.text,"stroke-width":5,fill:"none"},s),l.pad2d=s},makeKnob:function(e){let t=128,s=l.dom("svg",l.css.basic+"position:relative;",{viewBox:"0 0 128 "+t,width:t,height:t,preserveAspectRatio:"none"});l.dom("circle","",{cx:64,cy:64,r:34,fill:l.colors.button,stroke:"rgba(0,0,0,0.3)","stroke-width":8},s),l.dom("path","",{d:"",stroke:l.colors.text,"stroke-width":4,fill:"none","stroke-linecap":"round"},s),l.dom("circle","",{cx:64,cy:64,r:41,stroke:"rgba(0,0,0,0.1)","stroke-width":7,fill:"none"},s),l.dom("path","",{d:"",stroke:"rgba(255,255,255,0.3)","stroke-width":2,fill:"none","stroke-linecap":"round","stroke-opacity":.5},s),l.knob=s},makeCircular:function(e){let t=128,s=l.dom("svg",l.css.basic+"position:relative;",{viewBox:"0 0 128 "+t,width:t,height:t,preserveAspectRatio:"none"});l.dom("circle","",{cx:64,cy:64,r:40,stroke:"rgba(0,0,0,0.1)","stroke-width":10,fill:"none"},s),l.dom("path","",{d:"",stroke:l.colors.text,"stroke-width":7,fill:"none","stroke-linecap":"butt"},s),l.circular=s},makeJoystick:function(e){let t,s=128,i=Math.floor(49),h=Math.floor(.6*i),o=l.dom("svg",l.css.basic+"position:relative;",{viewBox:"0 0 128 "+s,width:s,height:s,preserveAspectRatio:"none"});if(l.dom("defs",null,{},o),l.dom("g",null,{},o),e===0){t=[[40,"rgb(0,0,0)",.3],[80,"rgb(0,0,0)",0],[90,"rgb(50,50,50)",.4],[100,"rgb(50,50,50)",0]],l.makeGradiant("radialGradient",{id:"grad",cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%"},o,t),t=[[60,"rgb(0,0,0)",.5],[100,"rgb(0,0,0)",0]],l.makeGradiant("radialGradient",{id:"gradS",cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%"},o,t);let r=["rgb(40,40,40)","rgb(48,48,48)","rgb(30,30,30)"],c=["rgb(1,90,197)","rgb(3,95,207)","rgb(0,65,167)"];t=[[30,r[0],1],[60,r[1],1],[80,r[1],1],[100,r[2],1]],l.makeGradiant("radialGradient",{id:"gradIn",cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%"},o,t),t=[[30,c[0],1],[60,c[1],1],[80,c[1],1],[100,c[2],1]],l.makeGradiant("radialGradient",{id:"gradIn2",cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%"},o,t),l.dom("circle","",{cx:64,cy:64,r:i,fill:"url(#grad)"},o),l.dom("circle","",{cx:69,cy:74,r:h+10,fill:"url(#gradS)"},o),l.dom("circle","",{cx:64,cy:64,r:h,fill:"url(#gradIn)"},o),l.joystick_0=o}else t=[[69,"rgb(0,0,0)",0],[70,"rgb(0,0,0)",.3],[100,"rgb(0,0,0)",0]],l.makeGradiant("radialGradient",{id:"gradX",cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%"},o,t),l.dom("circle","",{cx:64,cy:64,r:i,fill:"none",stroke:"rgba(100,100,100,0.25)","stroke-width":"4"},o),l.dom("circle","",{cx:64,cy:64,r:h+14,fill:"url(#gradX)"},o),l.dom("circle","",{cx:64,cy:64,r:h,fill:"none",stroke:"rgb(100,100,100)","stroke-width":"4"},o),l.joystick_1=o},makeColorRing:function(){let e=256,t=l.dom("svg",l.css.basic+"position:relative;",{viewBox:"0 0 256 "+e,width:e,height:e,preserveAspectRatio:"none"});l.dom("defs",null,{},t),l.dom("g",null,{},t);let s,i,h,o,r,c,d,m,g,f=128,p=8/113/24*Math.PI,x=0,b=[];for(c=0;c<=24;++c){if(h=c/24,o=h*l.TwoPI,s=.5*(x+o),i=1/Math.cos(.5*(o-x)),r=[Math.sin(x),-Math.cos(x),Math.sin(s)*i,-Math.cos(s)*i,Math.sin(o),-Math.cos(o)],b[1]=l.rgbToHex(l.hslToRgb([h,1,.5])),c>0){for(d=6;d--;)r[d]=(113*r[d]+f).toFixed(2);m=" M"+r[0]+" "+r[1]+" Q"+r[2]+" "+r[3]+" "+r[4]+" "+r[5],g=[[0,b[0],1],[100,b[1],1]],l.makeGradiant("linearGradient",{id:"G"+c,x1:r[0],y1:r[1],x2:r[4],y2:r[5],gradientUnits:"userSpaceOnUse"},t,g),l.dom("path","",{d:m,"stroke-width":30,stroke:"url(#G"+c+")","stroke-linecap":"butt"},t,1)}x=o-p,b[0]=b[1]}g=[[0,"#FFFFFF",1],[50,"#FFFFFF",0],[50,"#000000",0],[100,"#000000",1]],l.makeGradiant("linearGradient",{id:"GL0",x1:0,y1:f-84.9,x2:0,y2:212.9,gradientUnits:"userSpaceOnUse"},t,g),g=[[0,"#7f7f7f",1],[50,"#7f7f7f",.5],[100,"#7f7f7f",0]],l.makeGradiant("linearGradient",{id:"GL1",x1:78.95,y1:0,x2:226,y2:0,gradientUnits:"userSpaceOnUse"},t,g),l.dom("g",null,{"transform-origin":"128px 128px",transform:"rotate(0)"},t),l.dom("polygon","",{points:"78.95 43.1 78.95 212.85 226 128",fill:"red"},t,2),l.dom("polygon","",{points:"78.95 43.1 78.95 212.85 226 128",fill:"url(#GL1)","stroke-width":1,stroke:"url(#GL1)"},t,2),l.dom("polygon","",{points:"78.95 43.1 78.95 212.85 226 128",fill:"url(#GL0)","stroke-width":1,stroke:"url(#GL0)"},t,2),l.dom("path","",{d:"M 255.75 136.5 Q 256 132.3 256 128 256 123.7 255.75 119.5 L 241 128 255.75 136.5 Z",fill:"none","stroke-width":2,stroke:"#000"},t,2),l.dom("circle","",{cx:128,cy:128,r:6,"stroke-width":2,stroke:"#000",fill:"none"},t),l.colorRing=t},icon:function(e,t,s){s=s||40;let i=["<svg xmlns='"+l.svgns+"' version='1.1' xmlns:xlink='"+l.htmls+"' style='pointer-events:none;' preserveAspectRatio='xMinYMax meet' x='0px' y='0px' width='"+s+"px' height='"+s+"px' viewBox='0 0 256 256'><g>"];switch(e){case"logo":i[1]="<path id='logoin' fill='"+t+"' stroke='none' d='"+l.logoFill_d+"'/>";break;case"donate":i[1]="<path id='logoin' fill='"+t+"' stroke='none' d='"+l.logo_donate+"'/>";break;case"neo":i[1]="<path id='logoin' fill='"+t+"' stroke='none' d='"+l.logo_neo+"'/>";break;case"phy":i[1]="<path id='logoin' stroke='"+t+"' stroke-width='49' stroke-linejoin='round' stroke-linecap='butt' fill='none' d='"+l.logo_phy+"'/>";break;case"config":i[1]="<path id='logoin' stroke='"+t+"' stroke-width='49' stroke-linejoin='round' stroke-linecap='butt' fill='none' d='"+l.logo_config+"'/>";break;case"github":i[1]="<path id='logoin' fill='"+t+"' stroke='none' d='"+l.logo_github+"'/>";break;case"save":i[1]="<path stroke='"+t+"' stroke-width='4' stroke-linejoin='round' stroke-linecap='round' fill='none' d='M 26.125 17 L 20 22.95 14.05 17 M 20 9.95 L 20 22.95'/><path stroke='"+t,i[1]+="' stroke-width='2.5' stroke-linejoin='round' stroke-linecap='round' fill='none' d='M 32.6 23 L 32.6 25.5 Q 32.6 28.5 29.6 28.5 L 10.6 28.5 Q 7.6 28.5 7.6 25.5 L 7.6 23'/>"}return i[2]="</g></svg>",i.join(`
`)},logoFill_d:`
    M 171 150.75 L 171 33.25 155.5 33.25 155.5 150.75 Q 155.5 162.2 147.45 170.2 139.45 178.25 128 178.25 116.6 178.25 108.55 170.2 100.5 162.2 100.5 150.75 
    L 100.5 33.25 85 33.25 85 150.75 Q 85 168.65 97.55 181.15 110.15 193.75 128 193.75 145.9 193.75 158.4 181.15 171 168.65 171 150.75 
    M 200 33.25 L 184 33.25 184 150.8 Q 184 174.1 167.6 190.4 151.3 206.8 128 206.8 104.75 206.8 88.3 190.4 72 174.1 72 150.8 L 72 33.25 56 33.25 56 150.75 
    Q 56 180.55 77.05 201.6 98.2 222.75 128 222.75 157.8 222.75 178.9 201.6 200 180.55 200 150.75 L 200 33.25 Z
    `,logo_github:`
    M 180.5 70 Q 186.3 82.4 181.55 96.55 196.5 111.5 189.7 140.65 183.65 168.35 146 172.7 152.5 178.7 152.55 185.9 L 152.55 218.15 Q 152.84 224.56 159.15 223.3 
    159.21 223.3 159.25 223.3 181.14 216.25 198.7 198.7 228 169.4 228 128 228 86.6 198.7 57.3 169.4 28 128 28 86.6 28 57.3 57.3 28 86.6 28 128 28 169.4 57.3 198.7 74.85 
    216.25 96.75 223.3 96.78 223.3 96.8 223.3 103.16 224.54 103.45 218.15 L 103.45 200 Q 82.97 203.1 75.1 196.35 69.85 191.65 68.4 185.45 64.27 177.055 59.4 174.15 49.20 
    166.87 60.8 167.8 69.85 169.61 75.7 180 81.13 188.09 90 188.55 98.18 188.86 103.45 185.9 103.49 178.67 110 172.7 72.33 168.33 66.3 140.65 59.48 111.49 74.45 96.55 69.7 
    82.41 75.5 70 84.87 68.74 103.15 80 115.125 76.635 128 76.85 140.85 76.65 152.85 80 171.1 68.75 180.5 70 Z
    `,logo_neo:`
    M 219 52 L 206 52 206 166 Q 206 183.4 193.75 195.65 181.4 208 164 208 146.6 208 134.35 195.65 122 183.4 122 166 L 122 90 Q 122 77.6 113.15 68.85 104.4 60 92 60 79.55 
    60 70.75 68.85 62 77.6 62 90 L 62 204 75 204 75 90 Q 75 83 79.95 78 84.95 73 92 73 99 73 104 78 109 83 109 90 L 109 166 Q 109 188.8 125.15 204.85 141.2 221 164 221 
    186.75 221 202.95 204.85 219 188.8 219 166 L 219 52 M 194 52 L 181 52 181 166 Q 181 173 176.05 178 171.05 183 164 183 157 183 152 178 147 173 147 166 L 147 90 Q 147 
    67.2 130.85 51.15 114.8 35 92 35 69.25 35 53.05 51.15 37 67.2 37 90 L 37 204 50 204 50 90 Q 50 72.6 62.25 60.35 74.6 48 92 48 109.4 48 121.65 60.35 134 72.6 134 90 L 
    134 166 Q 134 178.4 142.85 187.15 151.6 196 164 196 176.45 196 185.25 187.15 194 178.4 194 166 L 194 52 Z
    `,logo_phy:`
    M 103.55 37.95 L 127.95 37.95 Q 162.35 37.95 186.5 55 210.9 72.35 210.9 96.5 210.9 120.65 186.5 137.7 162.35 155 127.95 155 L 127.95 237.95 M 127.95 155 
    Q 93.55 155 69.15 137.7 45 120.65 45 96.5 45 72.35 69.15 55 70.9 53.8 72.85 52.85 M 127.95 155 L 127.95 37.95
    `,logo_config:`
    M 204.35 51.65 L 173.25 82.75 Q 192 101.5 192 128 L 236 128 M 192 128 Q 192 154.55 173.25 173.25 L 204.4 204.4 M 51.65 51.65 L 82.75 82.75 Q 101.5 64 128 64 
    L 128 20 M 51.6 204.4 L 82.75 173.25 Q 64 154.55 64 128 L 20 128 M 128 236 L 128 192 Q 101.5 192 82.75 173.25 M 64 128 Q 64 101.5 82.75 82.75 M 173.25 173.25 
    Q 154.55 192 128 192 M 128 64 Q 154.55 64 173.25 82.75
    `,logo_donate:`
    M 171.3 80.3 Q 179.5 62.15 171.3 45.8 164.1 32.5 141.35 30.1 L 94.35 30.1 Q 89.35 30.4 88.3 35.15 L 70.5 148.05 Q 70.2 152.5 73.7 152.6 L 100.95 152.6 107 111.6 Q 108.75 
    106.55 112.6 106.45 130.45 108.05 145.3 103.9 163.35 98.75 171.3 80.3 M 179.8 71.5 Q 178.6 79.75 174.9 87.85 168.45 102.9 151.9 109.15 140.65 113.95 117.55 113 113.15 
    112.75 111 117.45 L 102.7 169.95 Q 102.45 173.8 105.5 173.85 L 128.95 173.85 Q 132.2 174.2 133.35 169.65 L 138.3 139.95 Q 139.75 135.6 143.1 135.5 146.6 135.75 150.6 135.65 
    154.55 135.5 157.35 135.1 160.15 134.7 166.75 132.35 181.35 127.4 187.9 111.2 194.25 95.75 189.5 81.95 186.75 74.85 179.8 71.5 M 103.5 209.9 Q 103.5 202.85 99.7 198.85 95.95 
    194.75 89.4 194.75 82.8 194.75 79.05 198.85 75.3 202.9 75.3 209.9 75.3 216.85 79.05 220.95 82.8 225.05 89.4 225.05 95.95 225.05 99.7 221 103.5 216.95 103.5 209.9 M 95.45 205.5 
    Q 95.95 207.3 95.95 209.9 95.95 212.65 95.45 214.35 94.95 216 94 217.3 93.1 218.45 91.9 219 90.7 219.55 89.4 219.55 88.15 219.55 86.95 219.05 85.75 218.55 84.8 217.3 83.9 216.15 
    83.4 214.35 82.85 212.6 82.85 209.9 82.85 207.3 83.4 205.45 83.95 203.55 84.85 202.45 85.9 201.2 86.95 200.75 88.05 200.25 89.4 200.25 90.7 200.25 91.85 200.8 93.05 201.3 94 202.5 
    94.9 203.65 95.45 205.5 M 153.3 195.35 L 145.3 195.35 135.5 224.45 142.8 224.45 144.6 218.5 153.75 218.5 155.6 224.45 163.1 224.45 153.3 195.35 M 152.15 213.25 L 146.25 213.25 
    149.2 203.65 152.15 213.25 M 116.75 195.35 L 107.8 195.35 107.8 224.45 114.5 224.45 114.5 204.2 125.7 224.45 132.75 224.45 132.75 195.35 126.05 195.35 126.05 212.05 116.75 195.35 M 
    66.5 197.65 Q 64.15 196.15 61.45 195.75 58.8 195.35 55.75 195.35 L 46.7 195.35 46.7 224.45 55.8 224.45 Q 58.8 224.45 61.5 224.05 64.15 223.6 66.4 222.15 69.15 220.45 70.9 217.2 
    72.7 214 72.7 209.95 72.7 205.7 71 202.6 69.35 199.5 66.5 197.65 M 64.2 205 Q 65.2 207 65.2 209.9 65.2 212.75 64.25 214.75 63.3 216.75 61.5 217.85 60 218.85 58.3 218.9 56.6 219 
    54.15 219 L 54 219 54 200.8 54.15 200.8 Q 56.4 200.8 58.05 200.9 59.7 200.95 61.15 201.75 63.2 202.95 64.2 205 M 210.2 195.35 L 190.5 195.35 190.5 224.45 210.2 224.45 210.2 218.9 
    197.75 218.9 197.75 211.55 209.2 211.55 209.2 206 197.75 206 197.75 200.9 210.2 200.9 210.2 195.35 M 187.5 195.35 L 163 195.35 163 200.9 171.6 200.9 171.6 224.45 178.9 224.45 178.9 
    200.9 187.5 200.9 187.5 195.35 Z
    `};l.setText();const a=l;class I{static autoTypes(t){let s=[];switch(t){case"svg":s=[{accept:{"image/svg+xml":".svg"}}];break;case"wav":s=[{accept:{"audio/wav":".wav"}}];break;case"mp3":s=[{accept:{"audio/mpeg":".mp3"}}];break;case"mp4":s=[{accept:{"video/mp4":".mp4"}}];break;case"bin":case"hex":s=[{description:"Binary Files",accept:{"application/octet-stream":[".bin",".hex"]}}];break;case"text":s=[{description:"Text Files",accept:{"text/plain":[".txt",".text"],"text/html":[".html",".htm"]}}];break;case"json":s=[{description:"JSON Files",accept:{"application/json":[".json"]}}];break;case"js":s=[{description:"JavaScript Files",accept:{"text/javascript":[".js"]}}];break;case"image":s=[{description:"Images",accept:{"image/*":[".png",".gif",".jpeg",".jpg"]}}];break;case"icon":s=[{description:"Icons",accept:{"image/x-ico":[".ico"]}}];break;case"lut":s=[{description:"Lut",accept:{"text/plain":[".cube",".3dl"]}}]}return s}static async load(t={}){typeof window.showOpenFilePicker!="function"&&(window.showOpenFilePicker=I.showOpenFilePickerPolyfill);try{let s=t.type||"";const i={excludeAcceptAllOption:!!s,multiple:!1};i.types=I.autoTypes(s);const h=await window.showOpenFilePicker(i),o=await h[0].getFile();if(!o)return null;let r=o.name,c=r.substring(r.lastIndexOf(".")+1,r.length);const d=["png","jpg","jpeg","mp4","webm","ogg","mp3"],m=["sea","z","hex","bvh","BVH","glb","gltf"],g=new FileReader;d.indexOf(c)!==-1?g.readAsDataURL(o):m.indexOf(c)!==-1?g.readAsArrayBuffer(o):g.readAsText(o),g.onload=function(f){let p=f.target.result;switch(s){case"image":let x=new Image;x.onload=function(){t.callback&&t.callback(x,r,c)},x.src=p;break;case"json":t.callback&&t.callback(JSON.parse(p),r,c);break;default:t.callback&&t.callback(p,r,c)}}}catch(s){console.log(s),t.always&&t.callback&&t.callback(null)}}static showOpenFilePickerPolyfill(t){return new Promise(s=>{const i=document.createElement("input");i.type="file",i.multiple=t.multiple,i.accept=t.types.map(h=>h.accept).flatMap(h=>Object.keys(h).flatMap(o=>h[o])).join(","),i.addEventListener("change",()=>{s([...i.files].map(h=>({getFile:async()=>new Promise(o=>{o(h)})})))}),i.click()})}static async save(t={}){let s=!1;typeof window.showSaveFilePicker!="function"&&(window.showSaveFilePicker=I.showSaveFilePickerPolyfill,s=!0);try{let i=t.type||"";const h={suggestedName:t.name||"hello",data:t.data||""};h.types=I.autoTypes(i),h.finalType=Object.keys(h.types[0].accept)[0],h.suggestedName+=h.types[0].accept[h.finalType][0];const o=await window.showSaveFilePicker(h);if(s)return;const r=await o.createWritable();let c=new Blob([h.data],{type:h.finalType});await r.write(c),await r.close()}catch(i){console.log(i)}}static showSaveFilePickerPolyfill(t){return new Promise(s=>{const i=document.createElement("a");i.download=t.suggestedName||"my-file.txt";let h=new Blob([t.data],{type:t.finalType});i.href=URL.createObjectURL(h),i.addEventListener("click",()=>{s(setTimeout(()=>URL.revokeObjectURL(i.href),1e3))}),i.click()})}static async getFolder(){try{const t=await window.showDirectoryPicker(),s=[];for await(const i of t.values()){const h=await i.getFile();s.push(h)}return console.log(s),s}catch(t){console.log(t)}}}class w{constructor(t=0,s=0){this.x=t,this.y=s}set(t,s){return this.x=t,this.y=s,this}divide(t){return this.x/=t.x,this.y/=t.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divideScalar(t){return this.multiplyScalar(1/t)}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}angle(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t}addScalar(t){return this.x+=t,this.y+=t,this}negate(){return this.x*=-1,this.y*=-1,this}neg(){return this.x=-1,this.y=-1,this}isZero(){return this.x===0&&this.y===0}copy(t){return this.x=t.x,this.y=t.y,this}equals(t){return t.x===this.x&&t.y===this.y}nearEquals(t,s){return t.x.toFixed(s)===this.x.toFixed(s)&&t.y.toFixed(s)===this.y.toFixed(s)}lerp(t,s){return t===null?(this.x-=this.x*s,this.y-=this.y*s):(this.x+=(t.x-this.x)*s,this.y+=(t.y-this.y)*s),this}}class v{constructor(t={}){this.lock=t.lock||!1,this.neverlock=!1,this.isSpace=t.isSpace||!1,this.main=t.main||null,this.isUI=t.isUI||!1,this.group=t.group||null,this.isListen=!1,this.top=0,this.ytop=0,this.dx=t.dx||0,this.isSelectable=t.selectable!==void 0&&t.selectable,this.unselectable=t.unselect!==void 0?t.unselect:this.isSelectable,this.ontop=!!t.ontop&&t.ontop,this.css=this.main?this.main.css:a.css,this.colors=a.defineColor(t,this.main?this.group?this.group.colors:this.main.colors:a.colors),this.overEffect=this.colors.showOver,this.svgs=a.svgs,this.zone={x:0,y:0,w:0,h:0,d:0},this.local=new w().neg(),this.isCanvasOnly=!1,this.isSelect=!1,this.p=t.p!==void 0?t.p:a.size.p,this.w=this.isUI?this.main.size.w:a.size.w,t.w!==void 0&&(this.w=t.w),this.h=this.isUI?this.main.size.h:a.size.h,t.h!==void 0&&(this.h=t.h),this.isSpace?this.lock=!0:this.h=this.h<11?11:this.h,this.fw=t.fw||0,this.autoWidth=t.auto||!0,this.isOpen=!1,this.radius=t.radius||this.colors.radius,this.transition=t.transition||a.transition,this.isNumber=!1,this.noNeg=t.noNeg||!1,this.allEqual=t.allEqual||!1,this.mono=!1,this.isEdit=!1,this.simple=t.simple||!1,this.simple&&(this.sa=0),this.setSize(this.w),t.sa!==void 0&&(this.sa=t.sa),t.sb!==void 0&&(this.sb=t.sb),this.simple&&(this.sb=this.w-this.sa),this.sc=t.sc===void 0?47:t.sc,this.objectLink=null,this.isSend=!1,this.objectKey=null,this.txt=t.name||"",this.name=t.rename||this.txt,this.target=t.target||null,this.callback=t.callback===void 0?null:t.callback,this.endCallback=null,this.openCallback=t.openCallback===void 0?null:t.openCallback,this.closeCallback=t.closeCallback===void 0?null:t.closeCallback,this.callback===null&&this.isUI&&this.main.callback!==null&&(this.callback=this.group?this.group.callback:this.main.callback),this.c=[],this.s=[],this.useFlex=!!this.isUI&&this.main.useFlex;let s=this.useFlex?"display:flex; justify-content:center; align-items:center; text-align:center; flex: 1 100%;":"float:left;";this.c[0]=a.dom("div",this.css.basic+s+"position:relative; height:20px;"),this.s[0]=this.c[0].style,this.margin=this.colors.sy,this.mtop=0;let i=a.isDivid(this.margin);if(this.isUI&&this.margin&&(this.s[0].boxSizing="content-box",i?(this.mtop=.5*this.margin,this.s[0].borderTop=this.mtop+"px solid transparent",this.s[0].borderBottom=this.mtop+"px solid transparent"):this.s[0].borderBottom=this.margin+"px solid transparent"),this.simple||(this.c[1]=a.dom("div",this.css.txt+this.css.middle),this.s[1]=this.c[1].style,this.c[1].textContent=this.name,this.s[1].color=this.lock?this.colors.titleoff:this.colors.title),t.pos){this.s[0].position="absolute";for(let h in t.pos)this.s[0][h]=t.pos[h];this.mono=!0}t.css&&(this.s[0].cssText=t.css)}init(){this.ytop=this.top+this.mtop,this.zone.h=this.h+this.margin,this.zone.w=this.w;let t=this.s,s=this.c;t[0].height=this.h+"px",this.isUI&&(t[0].background=this.colors.background),!this.autoWidth&&this.useFlex?(t[0].flex="1 0 auto",t[0].minWidth=this.minw+"px",t[0].textAlign="center"):this.isUI&&(t[0].width="100%"),s[1]!==void 0&&this.autoWidth&&(t[1]=s[1].style,t[1].top="1px",t[1].height=this.h-2+"px");let i=a.frag;for(let o=1,r=s.length;o!==r;o++)s[o]!==void 0&&(i.appendChild(s[o]),t[o]=s[o].style);let h=this.target!==null?this.target:this.isUI?this.main.inner:document.body;this.ontop?h.insertAdjacentElement("afterbegin",s[0]):h.appendChild(s[0]),s[0].appendChild(i),this.rSize(),this.isUI||(this.c[0].style.pointerEvents="auto",u.add(this))}addTransition(){this.baseH&&this.transition&&this.isUI&&(this.c[0].style.transition="height "+this.transition+"s ease-out")}dom(t,s,i,h,o){return a.dom(t,s,i,h,o)}setSvg(t,s,i,h,o){a.setSvg(t,s,i,h,o)}setCss(t,s){a.setCss(t,s)}clamp(t,s,i){return a.clamp(t,s,i)}getColorRing(){return a.colorRing||a.makeColorRing(),a.clone(a.colorRing)}getJoystick(t){return a["joystick_"+t]||a.makeJoystick(t),a.clone(a["joystick_"+t])}getCircular(t){return a.circular||a.makeCircular(t),a.clone(a.circular)}getKnob(t){return a.knob||a.makeKnob(t),a.clone(a.knob)}getPad2d(t){return a.pad2d||a.makePad(t),a.clone(a.pad2d)}cursor(t){u.cursor(t)}update(){}reset(){}content(){return this.c[0]}getDom(){return this.c[0]}uiout(){this.lock||this.overEffect&&this.s&&(this.s[0].background=this.colors.background)}uiover(){this.lock||this.overEffect&&this.s&&(this.s[0].background=this.colors.backgroundOver)}rename(t){this.c[1]!==void 0&&(this.c[1].textContent=t)}listen(){return this.isListen=u.addListen(this),this}listening(){this.objectLink!==null&&(this.isSend||this.isEdit||this.setValue(this.objectLink[this.objectKey]))}setValue(t){this.isNumber?this.value=this.numValue(t):this.value=t,this.update()}onChange(t){if(!this.isSpace)return this.callback=t||null,this}onFinishChange(t){if(!this.isSpace)return this.callback=null,this.endCallback=t,this}onOpen(t){return this.openCallback=t,this}onClose(t){return this.closeCallback=t,this}send(t){(t=t||this.value)instanceof Array&&t.length===1&&(t=t[0]),this.isSend=!0,this.objectLink!==null&&(this.objectLink[this.objectKey]=t),this.callback&&this.callback(t,this.objectKey),this.isSend=!1}sendEnd(t){(t=t||this.value)instanceof Array&&t.length===1&&(t=t[0]),this.endCallback&&this.endCallback(t),this.objectLink!==null&&(this.objectLink[this.objectKey]=t)}dispose(){this.isListen&&u.removeListen(this),a.clear(this.c[0]),this.target!==null?this.group!==null?this.group.clearOne(this):this.target.removeChild(this.c[0]):this.isUI?this.main.clearOne(this):document.body.removeChild(this.c[0]),this.isUI||u.remove(this),this.c=null,this.s=null,this.callback=null,this.target=null,this.isListen=!1}clear(){}getWidth(){let t=u.getWidth(this);t&&(this.w=t)}setSize(t){if(this.autoWidth)if(this.w=t,this.simple)this.sb=this.w-this.sa;else{let s=this.w*(this.p/100);this.sa=Math.floor(s+8),this.sb=Math.floor(this.w-s-16)}}rSize(){this.autoWidth&&(this.isUI||(this.s[0].width=this.w+"px"),this.simple||(this.s[1].width=this.sa+"px"))}setTypeNumber(t){let s;switch(this.isNumber=!0,this.value=0,t.value!==void 0&&(typeof t.value=="string"?this.value=1*t.value:this.value=t.value),this.min=t.min===void 0?-1/0:t.min,this.max=t.max===void 0?1/0:t.max,this.precision=t.precision===void 0?2:t.precision,this.precision){case 0:s=1;break;case 1:s=.1;break;case 2:s=.01;break;case 3:s=.001;break;case 4:s=1e-4;break;case 5:s=1e-5;break;case 6:s=1e-6}this.step=t.step===void 0?s:t.step,this.range=this.max-this.min,this.value=this.numValue(this.value)}numValue(t){return this.noNeg&&(t=Math.abs(t)),1*Math.min(this.max,Math.max(this.min,t)).toFixed(this.precision)}handleEvent(t){if(!this.lock)return this.neverlock&&(u.lock=!1),this[t.type]?this[t.type](t):console.error(t.type,"this type of event no existe !")}wheel(t){return!1}mousedown(t){return!1}mousemove(t){return!1}mouseup(t){return!1}keydown(t){return!1}keyup(t){return!1}setReferency(t,s){this.objectLink=t,this.objectKey=s}display(t=!1){this.s[0].visibility=t?"visible":"hidden"}open(){this.isOpen||(this.isOpen=!0,u.needResize=!0,this.openCallback&&this.openCallback())}close(){this.isOpen&&(this.isOpen=!1,u.needResize=!0,this.closeCallback&&this.closeCallback())}needZone(){u.needReZone=!0}rezone(){u.needReZone=!0}select(){}unselect(){}setInput(t){u.setInput(t,this)}upInput(t,s){return u.upInput(t,s)}selected(t){this.isSelect=t||!1}}class E extends v{constructor(t={}){super(t),this.value=t.value||!1,this.model=t.mode!==void 0?t.mode:0,this.onName=t.rename||this.txt,t.onName&&(t.onname=t.onName),t.onname&&(this.onName=t.onname),this.inh=t.inh||Math.floor(.8*this.h),this.inw=t.inw||36;let s=this.colors;if(this.model===0){let i=Math.floor(.5*this.h)-.5*(this.inh-2);this.c[2]=this.dom("div",this.css.basic+"background:"+s.inputBg+"; height:"+(this.inh-2)+"px; width:"+this.inw+"px; top:"+i+"px; border-radius:10px; border:2px solid "+s.back),this.c[3]=this.dom("div",this.css.basic+"height:"+(this.inh-6)+"px; width:16px; top:"+(i+2)+"px; border-radius:10px; background:"+s.button+";")}else this.p=0,this.c[1]!==void 0&&(this.c[1].textContent=""),this.c[2]=this.dom("div",this.css.txt+this.css.button+"top:1px; background:"+s.button+"; height:"+(this.h-2)+"px; border:"+s.borderSize+"px solid "+s.border+"; border-radius:"+this.radius+"px;");this.stat=-1,this.init(),this.update()}mousedown(t){return this.value=!this.value,this.update(!0),this.mousemove(t)}mousemove(t){return this.cursor("pointer"),this.mode(!0)}reset(){return this.cursor(),this.mode()}mode(t){let s,i=!1,h=this.colors,o=this.s,r=this.value;if(s=t?r?4:3:r?2:1,this.stat!==s){if(this.stat=s,this.model!==0){switch(s){case 1:o[2].color=h.text,o[2].background=h.button;break;case 2:o[2].color=h.textSelect,o[2].background=h.select;break;case 3:o[2].color=h.textOver,o[2].background=h.overoff;break;case 4:o[2].color=h.textOver,o[2].background=h.over}this.c[2].innerHTML=r?this.onName:this.name}else{switch(s){case 1:o[2].background=o[2].borderColor=h.backoff,o[3].background=h.button;break;case 2:o[2].background=o[2].borderColor=h.back,o[3].background=h.textOver;break;case 3:o[2].background=o[2].borderColor=h.back,o[3].background=h.overoff;break;case 4:o[2].background=o[2].borderColor=h.backoff,o[3].background=h.textSelect}o[3].marginLeft=r?"17px":"2px",this.c[1].textContent=r?this.onName:this.name}i=!0}return i}update(t){this.mode(),t&&this.send()}rSize(){super.rSize();let t=this.s,s=this.w-10-this.inw;this.model===0?(t[2].left=s+"px",t[3].left=s+"px"):(t[2].left=this.sa+"px",t[2].width=this.sb+"px")}}class z extends v{constructor(t={}){super(t),this.value="",t.value!==void 0&&(this.value=t.value),this.values=t.value||this.txt,t.values&&(this.values=t.values),t.values||t.value||(this.txt=""),this.onName=t.onName||null,this.on=!1,this.bw=t.forceWidth||0,t.bw&&(this.bw=t.bw),this.space=t.space||3,typeof this.values=="string"&&(this.values=[this.values]),this.isDown=!1,this.neverlock=!0,this.res=0,this.lng=this.values.length,this.tmp=[],this.stat=[];let s,i=this.colors;for(let h=0;h<this.lng;h++)s=!1,this.values[h]===this.value&&this.isSelectable&&(s=!0),this.c[h+2]=this.dom("div",this.css.txt+this.css.button+"top:1px; height:"+(this.h-2)+"px; border:"+i.borderSize+"px solid "+i.border+"; border-radius:"+this.radius+"px;"),this.c[h+2].style.background=s?i.select:i.button,this.c[h+2].style.color=s?i.textSelect:i.text,this.c[h+2].innerHTML=this.values[h],this.stat[h]=s?3:1;this.txt===""&&(this.p=0),(t.value||t.values)&&this.p!==0||this.c[1]!==void 0&&(this.c[1].textContent=""),this.init()}onOff(){this.on=!this.on,this.label(this.on?this.onName:this.value)}testZone(t){let s=this.local;if(s.x===-1&&s.y===-1)return-1;let i=this.lng,h=this.tmp;for(;i--;)if(s.x>h[i][0]&&s.x<h[i][2])return i;return-1}mouseup(t){return!!this.isDown&&(this.isDown=!1,this.res!==-1&&(this.value===this.values[this.res]&&this.unselectable?this.value="":this.value=this.values[this.res],this.onName!==null&&this.onOff(),this.send()),this.mousemove(t))}mousedown(t){return!this.isDown&&(this.isDown=!0,this.mousemove(t))}mousemove(t){let s=!1;return this.res=this.testZone(t),this.res!==-1?(this.cursor("pointer"),s=this.modes(this.isDown?3:2,this.res)):s=this.reset(),s}modes(t=1,s=-1){let i,h,o=this.lng,r=!1;for(;o--;)h=t,i=!!this.isSelectable&&this.values[o]===this.value,o===s?i&&h===2&&(h=3):(h=1,i&&(h=4)),r=this.mode(h,o);return r}mode(t,s){let i=!1,h=this.colors,o=this.s,r=s+2;if(this.stat[s]!==t){switch(this.stat[s]=t,t){case 1:o[r].color=h.text,o[r].background=h.button;break;case 2:o[r].color=h.textOver,o[r].background=h.overoff;break;case 3:o[r].color=h.textOver,o[r].background=h.over;break;case 4:o[r].color=h.textSelect,o[r].background=h.select}i=!0}return i}reset(){return this.res=-1,this.cursor(),this.modes()}label(t,s){s=s||2,this.c[s].textContent=t}switchValues(t,s){this.c[t+2].innerHTML=this.values[t]=s}icon(t,s=0,i=2){return this.s[i].padding=s+"px 0px",this.c[i].innerHTML=t,this}rSize(){super.rSize();let t=this.s,s=this.sb,i=this.sa,h=this.lng,o=this.colors.sx,r=(s-o*(h-1))/h;for(this.bw&&(r=this.bw<r?this.bw:r,i=.5*(this.w-(r*h+o*(h-1))));h--;)this.tmp[h]=[i+r*h+o*h,r],this.tmp[h][2]=this.tmp[h][0]+this.tmp[h][1],t[h+2].left=this.tmp[h][0]+"px",t[h+2].width=this.tmp[h][1]+"px"}}class P extends v{constructor(t={}){super(t),this.isCyclic=t.cyclic||!1,this.model=t.stype||0,t.mode!==void 0&&(this.model=t.mode),this.autoWidth=!1,this.minw=this.w,this.diam=t.diam||this.w,this.setTypeNumber(t),this.twoPi=a.TwoPI,this.pi90=a.pi90,this.offset=new w,this.h=t.h||this.w+10,this.c[0].style.width=this.w+"px",this.c[0].style.display="block",this.c[1]!==void 0&&(this.c[1].style.width="100%",this.c[1].style.justifyContent="center",this.top=10,this.h+=10),this.percent=0,this.cmode=0;let s=this.colors;this.c[2]=this.dom("div",this.css.txt+"justify-content:center; top:"+(this.h-20)+"px; width:100%; color:"+s.text),this.c[3]=this.getCircular(),this.setSvg(this.c[3],"stroke",s.back,0),this.setSvg(this.c[3],"d",this.makePath(),1),this.setSvg(this.c[3],"stroke",s.text,1),this.setSvg(this.c[3],"viewBox","0 0 "+this.diam+" "+this.diam),this.setCss(this.c[3],{width:this.diam,height:this.diam,left:0,top:this.top}),this.init(),this.update()}mode(t){if(this.cmode===t)return!1;let s,i=this.colors;switch(t){case 0:this.s[2].color=i.text,this.setSvg(this.c[3],"stroke",i.back,0),s=this.model>0?a.pack(a.lerpColor(a.unpack(a.ColorLuma(i.text,-.75)),a.unpack(i.text),this.percent)):i.text,this.setSvg(this.c[3],"stroke",s,1);break;case 1:this.s[2].color=i.textOver,this.setSvg(this.c[3],"stroke",i.backoff,0),s=this.model>0?a.pack(a.lerpColor(a.unpack(a.ColorLuma(i.text,-.75)),a.unpack(i.text),this.percent)):i.textOver,this.setSvg(this.c[3],"stroke",s,1)}return this.cmode=t,!0}reset(){this.isDown=!1}testZone(t){let s=this.local;return s.x===-1&&s.y===-1?"":s.y<=this.c[1].offsetHeight?"title":s.y>this.h-this.c[2].offsetHeight?"text":"circular"}mouseup(t){return this.isDown=!1,this.sendEnd(),this.mode(0)}mousedown(t){return this.isDown=!0,this.old=this.value,this.oldr=null,this.mousemove(t),this.mode(1)}mousemove(t){if(!this.isDown)return;let s=this.offset;if(s.x=.5*this.w-(t.clientX-this.zone.x),s.y=.5*this.diam-(t.clientY-this.zone.y-this.ytop),this.r=s.angle()-this.pi90,this.r=(this.r%this.twoPi+this.twoPi)%this.twoPi,this.oldr!==null){let r=this.r-this.oldr;this.r=Math.abs(r)>Math.PI?this.oldr:this.r,r>6&&(this.r=0),r<-6&&(this.r=this.twoPi)}let i=1/this.twoPi,h=this.r*i,o=this.range*h+this.min-this.old;(o>=this.step||o<=this.step)&&(o=~~(o/this.step),this.value=this.numValue(this.old+o*this.step),this.update(!0),this.old=this.value,this.oldr=this.r)}wheel(t){if(this.testZone(t)==="circular"){let s=this.value-this.step*t.delta;return s>this.max?s=this.isCyclic?this.min:this.max:s<this.min&&(s=this.isCyclic?this.max:this.min),this.setValue(s),this.old=s,this.update(!0),!0}return!1}makePath(){let t=40,s=this.percent*this.twoPi-.001,i=t+t*Math.sin(s)+24,h=t-t*Math.cos(s)+24;return"M 64,24 A 40,40 0 "+(s>Math.PI?1:0)+" 1 "+i+","+h}update(t){if(this.c[2].textContent=this.value,this.percent=(this.value-this.min)/this.range,this.setSvg(this.c[3],"d",this.makePath(),1),this.model>0){let s=this.colors,i=a.pack(a.lerpColor(a.unpack(a.ColorLuma(s.text,-.75)),a.unpack(s.text),this.percent));this.setSvg(this.c[3],"stroke",i,1)}t&&this.send()}}class j extends v{constructor(t={}){super(t),this.ctype=t.ctype||"hex",this.wfixe=256,this.cw=this.sb>256?256:this.sb,t.cw!=null&&(this.cw=t.cw),this.side=t.side||"down",this.up=this.side==="down"?0:1,this.baseH=this.h,this.offset=new w,this.decal=new w,this.pp=new w;let s=this.colors;this.c[2]=this.dom("div",`${this.css.txt} ${this.css.middle} top:1px; height:${this.h-2}px; border-radius:${this.radius}px; text-shadow:none; border:${s.borderSize}px solid ${s.border};`),this.c[0].style.display="block",this.c[3]=this.getColorRing(),this.c[3].style.visibility="hidden",this.hsl=null,this.value="#ffffff",t.value!==void 0&&(t.value instanceof Array?this.value=a.rgbToHex(t.value):isNaN(t.value)?this.value=t.value:this.value=a.hexToHtml(t.value)),this.bcolor=null,this.isDown=!1,this.fistDown=!1,this.notext=t.notext||!1,this.tr=98,this.tsl=Math.sqrt(3)*this.tr,this.hue=0,this.d=256,this.init(),this.setColor(this.value),t.open!==void 0&&this.open()}testZone(t,s){let i=this.local;return i.x===-1&&i.y===-1?"":this.up&&this.isOpen?i.y>this.wfixe?"title":"color":i.y<this.baseH+2?"title":this.isOpen?"color":void 0}mouseup(t){this.isDown=!1,this.d=256}mousedown(t){let s=this.testZone(t.clientX,t.clientY);if(s==="title")return this.isOpen?this.close():this.open(),!0;s==="color"&&(this.isDown=!0,this.fistDown=!0,this.mousemove(t))}mousemove(t){let s,i,h,o,r,c,d,m,g,f=this.testZone(t.clientX,t.clientY),p=a;if(f==="title"&&this.cursor("pointer"),f==="color"&&(s=this.offset,s.x=t.clientX-(this.zone.x+this.decal.x+this.mid),s.y=t.clientY-(this.zone.y+this.decal.y+this.mid)-this.ytop,i=s.length()*this.ratio,g=s.angle(),g<0&&(g+=2*p.PI),i<128?this.cursor("crosshair"):this.isDown||this.cursor(),this.isDown&&(this.fistDown&&(this.d=i,this.fistDown=!1),this.d<128)))if(this.d>this.tr)h=(g+p.pi90)/p.TwoPI,this.hue=(h+1)%1,this.setHSL([(h+1)%1,this.hsl[1],this.hsl[2]]);else{d=s.x*this.ratio,m=s.y*this.ratio;let x=this.hue*p.TwoPI+p.PI;x<0&&(x+=2*p.PI),c=Math.atan2(-m,d),c<0&&(c+=2*p.PI);let b=(c+p.pi90+p.TwoPI+x)%p.TwoPI,y=b%(2/3*p.PI)-p.pi60,k=.5*this.tr,S=Math.tan(y)*k,M=Math.sqrt(d*d+m*m),C=Math.sqrt(k*k+S*S);if(M>C){let H=Math.tan(y)*M,L=Math.atan(H/C);L>p.pi60?L=p.pi60:L<-p.pi60&&(L=-p.pi60),c+=L-y,b=(c+p.pi90+p.TwoPI+x)%p.TwoPI,y=b%(2/3*p.PI)-p.pi60,S=Math.tan(y)*k,M=C=Math.sqrt(k*k+S*S)}r=Math.sin(b)*M/this.tsl+.5;let D=1-2*Math.abs(r-.5);o=(Math.cos(b)*M+this.tr/2)/(1.5*this.tr)/D,o=p.clamp(o,0,1),this.setHSL([this.hsl[0],o,r])}}setHeight(){this.h=this.isOpen?this.wfixe+this.baseH+5:this.baseH,this.s[0].height=this.h+"px",this.zone.h=this.h}parentHeight(t){this.group!==null?this.group.calc(t):this.isUI&&this.main.calc(t)}open(){super.open(),this.setHeight(),this.up&&(this.zone.y-=this.wfixe+5);let t=this.h-this.baseH;this.s[3].visibility="visible",this.parentHeight(t)}close(){super.close(),this.up&&(this.zone.y+=this.wfixe+5);let t=this.h-this.baseH;this.setHeight(),this.s[3].visibility="hidden",this.parentHeight(-t)}update(t){let s=a.rgbToHex(a.hslToRgb([this.hsl[0],1,.5]));this.moveMarkers(),this.value=this.bcolor,this.setSvg(this.c[3],"fill",s,2,0),this.s[2].background=this.bcolor,this.notext||(this.c[2].textContent=a.htmlToHex(this.bcolor)),this.invert=a.findDeepInver(this.rgb),this.s[2].color=this.invert?"#fff":"#000",t&&(this.ctype==="array"&&this.send(this.rgb),this.ctype==="rgb"&&this.send(a.htmlRgb(this.rgb)),this.ctype==="hex"&&this.send(a.htmlToHex(this.value)),this.ctype==="html"&&this.send())}setValue(t){t instanceof Array?this.value=a.rgbToHex(t):isNaN(t)?this.value=t:this.value=a.hexToHtml(t),this.setColor(this.value),this.update()}setColor(t){let s=a.unpack(t);return this.bcolor!==t&&s&&(this.bcolor=t,this.rgb=s,this.hsl=a.rgbToHsl(this.rgb),this.hue=this.hsl[0],this.update()),this}setHSL(t){return this.hsl=t,this.rgb=a.hslToRgb(t),this.bcolor=a.rgbToHex(this.rgb),this.update(!0),this}moveMarkers(){let t=this.pp,s=a;this.invert;let i=this.hsl[0]*s.TwoPI,h=2/3*s.PI,o=this.tr,r=this.hsl[0],c=this.hsl[1],d=this.hsl[2],m=(i-s.pi90)*s.todeg;r=-i+s.pi90;let g=Math.cos(r)*o,f=-Math.sin(r)*o,p=Math.cos(r-h)*o,x=-Math.sin(r-h)*o,b=Math.cos(r+h)*o,y=-Math.sin(r+h)*o,k=(p+b)/2,S=(x+y)/2;i=(1-2*Math.abs(d-.5))*c;let M=p+(b-p)*d+(g-k)*i,C=x+(y-x)*d+(f-S)*i;t.set(M,C).addScalar(128),this.setSvg(this.c[3],"transform","rotate("+m+" )",2),this.setSvg(this.c[3],"cx",t.x,3),this.setSvg(this.c[3],"cy",t.y,3),this.setSvg(this.c[3],"stroke",this.invert?"#fff":"#000",2,3),this.setSvg(this.c[3],"stroke",this.invert?"#fff":"#000",3),this.setSvg(this.c[3],"fill",this.bcolor,3)}rSize(){super.rSize();let t=this.s;t[2].width=this.sb+"px",t[2].left=this.sa+"px",this.cw=this.sb>256?256:this.sb,this.rSizeColor(this.cw),this.decal.x=Math.floor(.5*(this.w-this.wfixe))}rSizeColor(t){if(t===this.wfixe)return;this.wfixe=t;let s=this.s;this.decal.y=this.side==="up"?2:this.baseH+2,this.mid=Math.floor(.5*this.wfixe),this.setSvg(this.c[3],"viewBox","0 0 "+this.wfixe+" "+this.wfixe),s[3].width=this.wfixe+"px",s[3].height=this.wfixe+"px",s[3].top=this.decal.y+"px",this.ratio=256/this.wfixe,this.square=1/(this.wfixe/256*60),this.setHeight()}}class N extends v{constructor(t={}){super(t),this.round=Math.round,this.baseH=this.h,this.hplus=t.hplus||50,this.res=t.res||40,this.l=1,this.precision=t.precision||0,this.custom=t.custom||!1,this.names=t.names||["FPS","MS"];let s=t.cc||["220,220,220","255,255,0"];this.adding=t.adding||!1,this.range=t.range||[165,100,100],this.alpha=t.alpha||.25,this.values=[],this.points=[],this.textDisplay=[],this.custom||(this.now=u.getTime(),this.startTime=0,this.prevTime=0,this.frames=0,this.ms=0,this.fps=0,this.mem=0,this.mm=0,this.isMem=!(!self.performance||!self.performance.memory),this.isMem&&(this.names.push("MEM"),s.push("0,255,255")),this.txt=t.name||"Fps");let i=Math.floor(.5*this.h)-3;const h=this.colors;this.c[1].textContent=this.txt,this.c[0].style.cursor="pointer",this.c[0].style.pointerEvents="auto";let o="display:none; left:10px; top:"+this.h+"px; height:"+(this.hplus-8)+"px; box-sizing:border-box; background: rgba(0, 0, 0, 0.2); border:1px solid "+h.border+";";this.radius!==0&&(o+="border-radius:"+this.radius+"px;"),this.c[2]=this.dom("path",this.css.basic+o,{}),this.c[2].setAttribute("viewBox","0 0 "+this.res+" 50"),this.c[2].setAttribute("height","100%"),this.c[2].setAttribute("width","100%"),this.c[2].setAttribute("preserveAspectRatio","none"),this.c[3]=this.dom("path",this.css.basic+"position:absolute; width:6px; height:6px; left:0; top:"+i+"px;",{d:this.svgs.g1,fill:h.text,stroke:"none"}),this.c[4]=this.dom("div",this.css.txt+"position:absolute; left:10px; top:"+(this.h+2)+"px; display:none; width:100%; text-align:center;"),t.bottomLine&&(this.c[4]=this.dom("div",this.css.basic+"width:100%; bottom:0px; height:1px; background: rgba(255, 255, 255, 0.2);")),this.isShow=!1;let r=this.s;r[1].lineHeight=this.h-4,r[1].color=h.text,this.radius!==0&&(r[0].borderRadius=this.radius+"px"),this.colors.gborder!=="none"&&(r[0].border="1px solid "+h.gborder);let c=0;for(c=0;c<this.names.length;c++){let d=[],m=this.res+1;for(;m--;)d.push(50);this.range[c]=1/this.range[c]*49,this.points.push(d),this.values.push(0),this.textDisplay.push("<span style='color:rgb("+s[c]+")'> "+this.names[c]+" ")}for(c=this.names.length;c--;)this.dom("path",null,{fill:"rgba("+s[c]+","+this.alpha+")","stroke-width":1,stroke:"rgba("+s[c]+",1)","vector-effect":"non-scaling-stroke"},this.c[2]);this.init()}mousedown(t){this.isShow?this.close():this.open()}tick(t){this.values=t,this.isShow&&(this.drawGraph(),this.upText())}makePath(t){let s="";s+="M -1 50";for(let i=0;i<this.res+1;i++)s+=" L "+i+" "+t[i];return s+=" L "+(this.res+1)+" 50",s}upText(t){let s=t||this.values,i="";for(let h=0,o=this.names.length;h<o;h++)i+=this.textDisplay[h]+s[h].toFixed(this.precision)+"</span>";this.c[4].innerHTML=i}drawGraph(){let t,s=this.c[2],i=this.names.length,h=0,o=0;for(;i--;)t=this.adding?(this.values[o]+h)*this.range[o]:this.values[o]*this.range[o],this.points[o].shift(),this.points[o].push(50-t),this.setSvg(s,"d",this.makePath(this.points[o]),i+1),h+=this.values[o],o++}open(){super.open(),this.h=this.hplus+this.baseH,this.setSvg(this.c[3],"d",this.svgs.g2),this.group!==null?this.group.calc(this.hplus):this.isUI&&this.main.calc(this.hplus),this.s[0].height=this.h+"px",this.s[2].display="block",this.s[4].display="block",this.isShow=!0,this.custom||u.addListen(this)}close(){super.close(),this.h=this.baseH,this.setSvg(this.c[3],"d",this.svgs.g1),this.group!==null?this.group.calc(-this.hplus):this.isUI&&this.main.calc(-this.hplus),this.s[0].height=this.h+"px",this.s[2].display="none",this.s[4].display="none",this.isShow=!1,this.custom||u.removeListen(this),this.c[4].innerHTML=""}begin(){this.startTime=this.now()}end(){let t=this.now();if(this.ms=t-this.startTime,this.frames++,t>this.prevTime+1e3&&(this.fps=this.round(1e3*this.frames/(t-this.prevTime)),this.prevTime=t,this.frames=0,this.isMem)){let s=performance.memory.usedJSHeapSize,i=performance.memory.jsHeapSizeLimit;this.mem=this.round(954e-9*s),this.mm=s/i}return this.values=[this.fps,this.ms,this.mm],this.drawGraph(),this.upText([this.fps,this.ms,this.mem]),t}listening(){this.custom||(this.startTime=this.end())}rSize(){let t=this.s,s=this.w;t[3].left=this.sa+this.sb-6+"px",t[0].width=s+"px",t[1].width=s+"px",t[2].left="10px",t[2].width=s-20+"px",t[4].width=s-20+"px"}}class R extends v{constructor(t={}){super(t),this.value=t.value!==void 0?t.value:[0,0,0],this.lng=this.value.length,this.precision=t.precision!==void 0?t.precision:2,this.multiplicator=t.multiplicator||1,this.neg=t.neg||!1,this.line=t.line===void 0||t.line,this.autoWidth=t.autoWidth===void 0||t.autoWidth,this.isNumber=!1,this.isDown=!1,this.h=t.h||138,this.rh=this.h-10,this.top=0,this.c[0].style.width=this.w+"px",this.c[1]!==void 0&&(this.c[1].style.width=this.w+"px",this.autoWidth||(this.c[1].style.width="100%",this.c[1].style.justifyContent="center"),this.top=10,this.h+=10),this.gh=this.rh-28,this.gw=this.w-28,this.c[2]=this.dom("div",this.css.txt+"display:block; text-align:center; padding:0px 0px; top:"+(this.h-20)+"px; left:14px; width:"+this.gw+"px;  color:"+this.colors.text),this.c[2].innerHTML=this.valueToHtml();let s=this.dom("svg",this.css.basic,{viewBox:"0 0 "+this.w+" "+this.rh,width:this.w,height:this.rh,preserveAspectRatio:"none"});this.setCss(s,{width:this.w,height:this.rh,left:0,top:this.top}),this.dom("path","",{d:"",stroke:this.colors.text,"stroke-width":2,fill:"none","stroke-linecap":"butt"},s),this.dom("rect","",{x:10,y:10,width:this.gw+8,height:this.gh+8,stroke:"rgba(0,0,0,0.3)","stroke-width":1,fill:"none"},s),this.iw=(this.gw-4*(this.lng-1))/this.lng;let i=[];this.cMode=[],this.v=[];for(let h=0;h<this.lng;h++)i[h]=[14+h*this.iw+4*h,this.iw],i[h][2]=i[h][0]+i[h][1],this.cMode[h]=0,this.neg?this.v[h]=.5*(1+this.value[h]/this.multiplicator):this.v[h]=this.value[h]/this.multiplicator,this.dom("rect","",{x:i[h][0],y:14,width:i[h][1],height:1,fill:this.colors.text,"fill-opacity":.3},s);this.tmp=i,this.c[3]=s,this.init(),this.c[1]!==void 0&&(this.c[1].style.top="0px",this.c[1].style.height="20px",this.s[1].lineHeight="15px"),this.update(!1)}setValue(t){this.value=t,this.lng=this.value.length;for(var s=0;s<this.lng;s++)this.neg?this.v[s]=.5*(1+t[s]/this.multiplicator):this.v[s]=t[s]/this.multiplicator;this.update()}valueToHtml(){let t=this.lng,s=0,i='<table style="width:100%;"><tr>',h="width:"+100/this.lng+"%;";for(;t--;)s===this.lng-1?i+="<td style="+h+">"+this.value[s]+"</td></tr></table>":i+="<td style="+h+">"+this.value[s]+"</td>",s++;return i}updateSVG(){this.line&&this.setSvg(this.c[3],"d",this.makePath(),0);for(let t=0;t<this.lng;t++)this.setSvg(this.c[3],"height",this.v[t]*this.gh,t+2),this.setSvg(this.c[3],"y",this.gh-this.v[t]*this.gh+14,t+2),this.neg?this.value[t]=1*((2*this.v[t]-1)*this.multiplicator).toFixed(this.precision):this.value[t]=1*(this.v[t]*this.multiplicator).toFixed(this.precision);this.c[2].innerHTML=this.valueToHtml()}testZone(t){let s=this.local;if(s.x===-1&&s.y===-1)return"";let i=this.lng,h=this.tmp;if(s.y>this.top&&s.y<this.h-20){for(;i--;)if(s.x>h[i][0]&&s.x<h[i][2])return i}return""}mode(t,s){if(t===this.cMode[s])return!1;let i;switch(t){case 0:i=.3;break;case 1:i=.6;break;case 2:i=1}return this.reset(),this.setSvg(this.c[3],"fill-opacity",i,s+2),this.cMode[s]=t,!0}reset(){let t=!1,s=this.lng;for(;s--;)this.cMode[s]!==0&&(this.cMode[s]=0,this.setSvg(this.c[3],"fill-opacity",.3,s+2),t=!0);return t}mouseup(t){if(this.isDown=!1,this.current!==-1)return this.reset()}mousedown(t){return this.isDown=!0,this.mousemove(t)}mousemove(t){let s=!1,i=this.testZone(t);return i===""?s=this.reset():(s=this.mode(this.isDown?2:1,i),this.isDown&&(this.v[i]=this.clamp(1-(t.clientY-this.zone.y-this.ytop-10)/this.gh,0,1),this.update(!0))),s}update(t){this.updateSVG(),t&&this.send()}makePath(){let t,s,i,h,o,r,c="";for(let d=0;d<this.lng;d++)t=this.gh-this.v[d]*this.gh+14,s=14+d*this.iw+4*d,h=s+.5*this.iw,i=s+this.iw,c+=d===0?"M "+s+" "+t+" T "+h+" "+t:" C "+o+" "+r+","+s+" "+t+","+h+" "+t,d===this.lng-1&&(c+=" T "+i+" "+t),o=i,r=t;return c}rSize(){super.rSize();let t=this.s;this.c[1]!==void 0&&(t[1].width=this.w+"px"),t[3].width=this.w+"px";let s=this.w-28,i=(s-4*(this.lng-1))/this.lng,h=[];t[2].width=s+"px";for(let o=0;o<this.lng;o++)h[o]=[14+o*i+4*o,i],h[o][2]=h[o][0]+h[o][1];this.tmp=h}}class T extends v{constructor(t={}){t.isSpace=!0,t.margin=0,t.h||(t.h=10),super(t),this.init()}}class Z extends v{constructor(t={}){super(t),this.isGroup=!0,this.ADD=t.add,this.autoHeight=!0,this.uis=[],this.current=-1,this.proto=null,this.isEmpty=!0,this.decal=t.group?8:0,this.baseH=this.h,this.spaceY=new T({h:this.margin});let s=Math.floor(.5*this.h)-3;const i=this.colors;this.useFlex=!0;let h=this.useFlex?"display:flex; flex-flow: row wrap;":"";this.c[2]=this.dom("div",this.css.basic+h+"width:100%; left:0;  overflow:hidden; top:"+this.h+"px"),this.c[3]=this.dom("path",this.css.basic+"position:absolute; width:6px; height:6px; left:0; top:"+s+"px;",{d:this.svgs.g1,fill:i.text,stroke:"none"});let o=this.mtop===0?this.margin:this.mtop;this.c[4]=this.dom("div",this.css.basic+"width:100%; left:0; height:"+(o+1)+"px; top:"+(this.h-1)+"px; background:none;"),this.s,this.c[1].name="group",this.init(),this.setBG(t.bg),t.open&&this.open()}setBG(t){const s=this.colors,i=this.s;t!==void 0&&(s.groups=t),s.groups==="none"&&(s.groups=s.background),s.background="none",i[0].background="none",i[1].background=s.groups,i[2].background=s.groups,s.gborder!=="none"&&(i[1].border=s.borderSize+"px solid "+s.gborder),this.radius!==0&&(i[1].borderRadius=this.radius+"px",i[2].borderRadius=this.radius+"px")}testZone(t){let s=this.local;if(s.x===-1&&s.y===-1)return"";let i="";return s.y<this.baseH+this.margin?i="title":this.isOpen&&(i="content"),i}clearTarget(){return this.current!==-1&&(this.proto.s&&(this.proto.uiout(),this.proto.reset()),this.proto=null,this.current=-1,this.cursor(),!0)}reset(){this.clearTarget()}handleEvent(t){let s=t.type,i=!1,h=!1,o=this.testZone(t);if(o){switch(o){case"content":u.isMobile&&s==="mousedown"&&this.getNext(t,i),this.proto&&(h=this.proto.handleEvent(t)),u.lock||this.getNext(t,i);break;case"title":this.cursor("pointer"),s==="mousedown"&&(this.isOpen?this.close():this.open())}return this.isDown&&(i=!0),h&&(i=!0),i}}getNext(t,s){let i=u.findTarget(this.uis,t);i!==this.current&&(this.clearTarget(),this.current=i),i!==-1&&(this.proto=this.uis[this.current],this.proto.uiover())}add(){let t=arguments;typeof t[1]=="object"?(t[1].isUI=this.isUI,t[1].target=this.c[2],t[1].main=this.main,t[1].group=this):typeof arguments[1]=="string"&&(t[2]===void 0?[].push.call(t,{isUI:!0,target:this.c[2],main:this.main}):(t[2].isUI=!0,t[2].target=this.c[2],t[2].main=this.main,t[2].group=this));let s=this.ADD.apply(this,t);return s.isGroup&&(s.dx=8),u.forceZone=!0,this.uis.push(s),this.isEmpty=!1,s}remove(t){t.dispose&&t.dispose()}dispose(){this.clear(),this.isUI&&this.main.calc(),super.dispose()}clear(){this.empty()}empty(){this.close();let t,s=this.uis.length;for(;s--;)t=this.uis.pop(),this.c[2].removeChild(t.c[0]),t.clear(!0);this.isEmpty=!0,this.h=this.baseH}clearOne(t){let s=this.uis.indexOf(t);s!==-1&&(this.calc(-(this.uis[s].h+this.margin)),this.c[2].removeChild(this.uis[s].c[0]),this.uis.splice(s,1),this.uis.length===0&&(this.isEmpty=!0,this.close()))}open(){super.open(),this.setSvg(this.c[3],"d",this.svgs.g2),this.rSizeContent();const t=this.s,s=this.colors;t[2].top=this.h+this.mtop+"px",t[4].background=s.groups,this.radius&&(t[1].borderRadius="0px",t[2].borderRadius="0px",t[1].borderTopLeftRadius=this.radius+"px",t[1].borderTopRightRadius=this.radius+"px",t[2].borderBottomLeftRadius=this.radius+"px",t[2].borderBottomRightRadius=this.radius+"px"),s.gborder!=="none"&&(t[4].borderLeft=s.borderSize+"px solid "+s.gborder,t[4].borderRight=s.borderSize+"px solid "+s.gborder,t[2].border=s.borderSize+"px solid "+s.gborder,t[2].borderTop="none",t[1].borderBottom=s.borderSize+"px solid rgba(0,0,0,0)"),this.parentHeight()}close(){super.close(),this.setSvg(this.c[3],"d",this.svgs.g1),this.h=this.baseH;const t=this.s,s=this.colors;t[0].height=this.h+"px",t[2].top=this.h+this.mtop+"px",t[4].background="none",s.gborder!=="none"&&(t[4].border="none",t[2].border="none",t[1].border=s.borderSize+"px solid "+s.gborder),this.radius&&(t[1].borderRadius=this.radius+"px"),this.parentHeight()}calcUis(){!this.isOpen||this.isEmpty?this.h=this.baseH:this.h=u.calcUis([...this.uis,this.spaceY],this.zone,this.zone.y+this.baseH+this.margin,!0)+this.baseH,this.s[0].height=this.h+"px",this.s[2].height=this.h-this.baseH+"px"}parentHeight(t){this.group!==null?this.group.calc(t):this.isUI&&this.main.calc(t)}calc(t){this.isOpen&&(this.isUI?this.main.calc():this.calcUis(),this.s[0].height=this.h+"px",this.s[2].height=this.h+"px")}rSizeContent(){let t=this.uis.length;for(;t--;)this.uis[t].setSize(this.w),this.uis[t].rSize()}rSize(){super.rSize();let t=this.s;this.w=this.w-this.decal,t[3].left=this.sa+this.sb-6+"px",t[1].width=this.w+"px",t[2].width=this.w+"px",t[1].left=this.decal+"px",t[2].left=this.decal+"px",this.isOpen&&this.rSizeContent()}}class F extends v{constructor(t={}){super(t),this.autoWidth=!1,this.value=[0,0],this.minw=this.w,this.diam=t.diam||this.w,this.joyType="analogique",this.model=t.mode!==void 0?t.mode:0,this.precision=t.precision||2,this.multiplicator=t.multiplicator||1,this.pos=new w,this.tmp=new w,this.interval=null,this.c[0].style.display="block",this.haveText=t.text===void 0||t.text,this.distance=.5*this.diam*.25,this.h=t.h||this.w+(this.haveText?10:0),this.c[0].style.width=this.w+"px",this.c[1]!==void 0&&(this.c[1].style.width="100%",this.c[1].style.justifyContent="center",this.top=10,this.h+=10);let s=this.colors;this.c[2]=this.dom("div",this.css.txt+"justify-content:center; top:"+(this.h-20)+"px; width:100%; color:"+s.text),this.c[2].textContent=this.haveText?this.value:"",this.c[3]=this.getJoystick(this.model),this.setSvg(this.c[3],"viewBox","0 0 "+this.diam+" "+this.diam),this.setCss(this.c[3],{width:this.diam,height:this.diam,left:0,top:this.top}),this.mode(0),this.ratio=128/this.w,this.init(),this.update(!1)}mode(t){let s=this.colors;switch(t){case 0:this.model===0?(this.setSvg(this.c[3],"fill","url(#gradIn)",4),this.setSvg(this.c[3],"stroke","#000",4)):(this.setSvg(this.c[3],"stroke",s.joyOut,2),this.setSvg(this.c[3],"stroke",s.joyOut,4),this.setSvg(this.c[3],"fill","none",4));break;case 1:this.model===0?(this.setSvg(this.c[3],"fill","url(#gradIn2)",4),this.setSvg(this.c[3],"stroke","rgba(0,0,0,0)",4)):(this.setSvg(this.c[3],"stroke",s.joyOver,2),this.setSvg(this.c[3],"stroke",s.joySelect,4),this.setSvg(this.c[3],"fill",s.joyOver,4))}}addInterval(){this.interval!==null&&this.stopInterval(),this.pos.isZero()||(this.interval=setInterval((function(){this.update()}).bind(this),10))}stopInterval(){this.interval!==null&&(clearInterval(this.interval),this.interval=null)}reset(){this.addInterval(),this.mode(0)}mouseup(t){this.addInterval(),this.isDown=!1}mousedown(t){this.isDown=!0,this.mousemove(t),this.mode(2)}mousemove(t){if(this.mode(1),!!this.isDown){if(this.tmp.x=.5*this.w-(t.clientX-this.zone.x),this.tmp.y=.5*this.diam-(t.clientY-this.zone.y-this.ytop),this.tmp.length()>this.distance){let s=Math.atan2(this.tmp.x,this.tmp.y);this.tmp.x=Math.sin(s)*this.distance,this.tmp.y=Math.cos(s)*this.distance}this.pos.copy(this.tmp).divideScalar(this.distance).negate(),this.update()}}setValue(t){t===void 0&&(t=[0,0]),this.pos.set(t[0]||0,t[1]||0),this.updateSVG()}update(t){t===void 0&&(t=!0),this.interval!==null&&(this.isDown||(this.pos.lerp(null,.3),this.pos.x=Math.abs(this.pos.x)<.01?0:this.pos.x,this.pos.y=Math.abs(this.pos.y)<.01?0:this.pos.y,this.isUI&&this.main.isCanvas&&this.main.draw())),this.updateSVG(),t&&this.send(),this.pos.isZero()&&this.stopInterval()}updateSVG(){let t=.5*this.diam- -this.pos.x*this.distance,s=.5*this.diam- -this.pos.y*this.distance;if(this.model===0){let i=t+5*this.pos.x+5,h=s+5*this.pos.y+10;this.setSvg(this.c[3],"cx",i*this.ratio,3),this.setSvg(this.c[3],"cy",h*this.ratio,3)}else this.setSvg(this.c[3],"cx",t*this.ratio,3),this.setSvg(this.c[3],"cy",s*this.ratio,3);this.setSvg(this.c[3],"cx",t*this.ratio,4),this.setSvg(this.c[3],"cy",s*this.ratio,4),this.value[0]=1*(this.pos.x*this.multiplicator).toFixed(this.precision),this.value[1]=1*(this.pos.y*this.multiplicator).toFixed(this.precision),this.haveText&&(this.c[2].textContent=this.value)}clear(){this.stopInterval(),super.clear()}}class A extends v{constructor(t={}){super(t),this.isCyclic=t.cyclic||!1,this.model=t.stype||0,t.mode!==void 0&&(this.model=t.mode),this.autoWidth=!1,this.setTypeNumber(t),this.minw=this.w,this.diam=t.diam||this.w,this.mPI=.8*Math.PI,this.toDeg=180/Math.PI,this.cirRange=2*this.mPI,this.offset=new w,this.h=t.h||this.w+10,this.c[0].style.width=this.w+"px",this.c[0].style.display="block",this.c[1]!==void 0&&(this.c[1].style.width="100%",this.c[1].style.justifyContent="center",this.top=10,this.h+=10),this.percent=0,this.cmode=0;let s=this.colors;this.c[2]=this.dom("div",this.css.txt+"justify-content:center; top:"+(this.h-20)+"px; width:100%; color:"+s.text),this.c[3]=this.getKnob(),this.setSvg(this.c[3],"fill",s.button,0),this.setSvg(this.c[3],"stroke",s.text,1),this.setSvg(this.c[3],"stroke",s.text,3),this.setSvg(this.c[3],"d",this.makeGrad(),3),this.setSvg(this.c[3],"viewBox","0 0 "+this.diam+" "+this.diam),this.setCss(this.c[3],{width:this.diam,height:this.diam,left:0,top:this.top}),this.model>0&&(a.dom("path","",{d:"",stroke:s.text,"stroke-width":2,fill:"none","stroke-linecap":"round"},this.c[3]),this.model==2&&(a.addSVGGlowEffect(),this.setSvg(this.c[3],"style",'filter: url("#UILGlow");',4))),this.r=0,this.init(),this.update()}mode(t){let s=this.colors;if(this.cmode===t)return!1;switch(t){case 0:this.s[2].color=s.text,this.setSvg(this.c[3],"fill",s.button,0),this.setSvg(this.c[3],"stroke",s.text,1);break;case 1:this.s[2].color=s.textOver,this.setSvg(this.c[3],"fill",s.select,0),this.setSvg(this.c[3],"stroke",s.textOver,1)}return this.cmode=t,!0}testZone(t){let s=this.local;return s.x===-1&&s.y===-1?"":s.y<=this.c[1].offsetHeight?"title":s.y>this.h-this.c[2].offsetHeight?"text":"knob"}mouseup(t){return this.isDown=!1,this.sendEnd(),this.mode(0)}mousedown(t){return this.isDown=!0,this.old=this.value,this.oldr=null,this.mousemove(t),this.mode(1)}mousemove(t){if(!this.isDown)return;let s=this.offset;s.x=.5*this.w-(t.clientX-this.zone.x),s.y=.5*this.diam-(t.clientY-this.zone.y-this.ytop),this.r=-Math.atan2(s.x,s.y),this.oldr!==null&&(this.r=Math.abs(this.r-this.oldr)>Math.PI?this.oldr:this.r),this.r=this.r>this.mPI?this.mPI:this.r,this.r=this.r<-this.mPI?-this.mPI:this.r;let i=1/this.cirRange,h=(this.r+this.mPI)*i,o=this.range*h+this.min-this.old;(o>=this.step||o<=this.step)&&(o=Math.floor(o/this.step),this.value=this.numValue(this.old+o*this.step),this.update(!0),this.old=this.value,this.oldr=this.r)}wheel(t){if(this.testZone(t)==="knob"){let s=this.value-this.step*t.delta;return s>this.max?s=this.isCyclic?this.min:this.max:s<this.min&&(s=this.isCyclic?this.max:this.min),this.setValue(s),this.old=s,this.update(!0),!0}return!1}makeGrad(){let t,s,i,h,o,r,c,d="",m=64,g=Math.PI+this.mPI,f=Math.PI-this.mPI;this.step>5?(s=this.range/this.step,t=(g-f)/s):(t=(g-f)/m*2,s=32);for(let p=0;p<=s;++p)i=g-t*p,h=m+44*Math.sin(i),o=m+44*Math.cos(i),r=m+40*Math.sin(i),c=m+40*Math.cos(i),d+="M"+h+" "+o+" L"+r+" "+c+" ";return d}update(t){this.c[2].textContent=this.value,this.percent=(this.value-this.min)/this.range;let s=Math.PI+this.mPI,i=this.percent*this.cirRange-this.mPI,h=Math.sin(i),o=Math.cos(i),r=25*h+64,c=-25*o+64,d=20*h+64,m=-20*o+64;if(this.setSvg(this.c[3],"d","M "+r+" "+c+" L "+d+" "+m,1),this.model>0){let g=36*Math.sin(s)+64,f=36*Math.cos(s)+64,p=36*h+64,x=-36*o+64,b=i<=Math.PI-this.mPI?0:1;this.setSvg(this.c[3],"d","M "+g+","+f+" A 36,36 1 "+b+" 1 "+p+","+x,4);let y=a.pack(a.lerpColor(a.unpack(a.ColorLuma(this.colors.text,-.75)),a.unpack(this.colors.text),this.percent));this.setSvg(this.c[3],"stroke",y,4)}t&&this.send()}}class G extends v{constructor(t={}){super(t),this.hideCurrent=!1,this.path=t.path||"",this.format=t.format||"",this.isWithImage=this.path!=="",this.preLoadComplete=!1,this.tmpImage={},this.tmpUrl=[],this.m=t.m!==void 0?t.m:5;let s=t.align||"left",i=t.scrollSize||10;this.ss=i+1,this.sMode=0,this.tMode=0,this.listOnly=t.listOnly||!1,this.staticTop=t.staticTop||!1,this.isSelectable=this.listOnly,t.select!==void 0&&(t.selectable=t.select),t.selectable!==void 0&&(this.isSelectable=t.selectable),this.txt===""&&(this.p=0);let h=Math.floor(.5*this.h)-3,o=this.colors;if(this.c[2]=this.dom("div",this.css.basic+"top:0; display:none; border-radius:"+this.radius+"px;"),this.c[3]=this.dom("div",this.css.item+"padding:0px "+this.m+"px; margin-bottom:0px; position:absolute; justify-content:"+s+"; text-align:"+s+"; line-height:"+(this.h-4)+"px; top:1px; background:"+o.button+"; height:"+(this.h-2)+"px; border:1px solid "+o.border+"; border-radius:"+this.radius+"px;"),this.c[4]=this.dom("path",this.css.basic+"position:absolute; width:6px; height:6px; top:"+h+"px;",{d:this.svgs.g1,fill:o.text,stroke:"none"}),this.scrollerBack=this.dom("div",this.css.basic+"right:0px; width:"+i+"px; background:"+o.back+"; display:none;"),this.scroller=this.dom("div",this.css.basic+"right:"+.5*(i-.25*i)+"px; width:"+.25*i+"px; background:"+o.text+"; display:none; "),this.c[3].style.color=o.text,this.list=[],this.refObject=null,t.list){if(t.list instanceof Array)this.list=t.list;else if(t.list instanceof Object){this.refObject=t.list;for(let r in this.refObject)this.list.push(r)}}this.items=[],this.prevName="",this.tmpId=0,this.baseH=this.h,this.itemHeight=t.itemHeight||this.h,this.full=t.full||!1,this.py=0,this.ww=this.sb,this.scroll=!1,this.isDown=!1,this.current=null,this.side=t.side||"down",this.up=this.side==="down"?0:1,this.up?(this.c[2].style.top="auto",this.c[3].style.top="auto",this.c[4].style.top="auto",this.c[2].style.bottom=this.h-2+"px",this.c[3].style.bottom="1px",this.c[4].style.bottom=h+"px"):this.c[2].style.top=this.baseH+"px",this.listIn=this.dom("div",this.css.basic+"left:0; top:0; width:100%; background:none;"),this.listIn.name="list",this.topList=0,this.c[2].appendChild(this.listIn),this.c[2].appendChild(this.scrollerBack),this.c[2].appendChild(this.scroller),t.value!==void 0?isNaN(t.value)?this.value=t.value:this.value=this.list[t.value]:this.value=this.list[0],this.isOpenOnStart=t.open||!1,this.listOnly&&(this.baseH=5,this.c[3].style.display="none",this.c[4].style.display="none",this.c[2].style.top=this.baseH+"px",this.isOpenOnStart=!0),this.miniCanvas=t.miniCanvas||!1,this.canvasBg=t.canvasBg||"rgba(0,0,0,0)",this.imageSize=t.imageSize||[20,20],this.drag=t.drag||!1,this.dragout=t.dragout||!1,this.dragstart=t.dragstart||null,this.dragend=t.dragend||null,this.setList(this.list),this.init(),this.isWithImage&&this.preloadImage(),this.isOpenOnStart&&this.open(!0),this.baseH+=this.mtop}preloadImage(){this.preLoadComplete=!1,this.tmpImage={};for(let t=0;t<this.list.length;t++)this.tmpUrl.push(this.list[t]);this.loadOne()}nextImg(){this.c!==null&&(this.tmpUrl.shift(),this.tmpUrl.length===0?(this.preLoadComplete=!0,this.addImages()):this.loadOne())}loadOne(){let t=this,s=this.tmpUrl[0],i=document.createElement("img");i.style.cssText="position:absolute; width:"+t.imageSize[0]+"px; height:"+t.imageSize[1]+"px",i.setAttribute("src",this.path+s+this.format),i.addEventListener("load",function(){t.imageSize[2]=i.width,t.imageSize[3]=i.height,t.tmpImage[s]=i,t.nextImg()})}testZone(t){let s=this.local;if(s.x===-1&&s.y===-1)return"";if(this.up&&this.isOpen){if(s.y>this.h-this.baseH)return"title";if(this.scroll&&s.x>this.sa+this.sb-this.ss)return"scroll";if(s.x>this.sa)return this.testItems(s.y-this.baseH)}else{if(s.y<this.baseH+2)return"title";if(this.isOpen){if(this.scroll&&s.x>this.sa+this.sb-this.ss)return"scroll";if(s.x>this.sa)return this.testItems(s.y-this.baseH)}}return""}testItems(t){let s,i,h,o="",r=this.items,c=r.length;for(;c--;)if(s=r[c],i=s.posy+this.topList,h=s.posy+this.itemHeight+1+this.topList,t>=i&&t<=h)return o="item"+c,this.modeItem(0),this.current=s,this.modeItem(1),o;return o}modeItem(t){if(!this.current)return;this.current.select&&t===0&&(t=2);let s=this.colors;switch(t){case 0:this.current.style.background=s.back,this.current.style.color=s.text;break;case 1:this.current.style.background=s.over,this.current.style.color=s.textOver;break;case 2:this.current.style.background=s.select,this.current.style.color=s.textSelect}}unSelected(){this.current&&(this.modeItem(0),this.current=null)}selected(){this.current&&(this.resetItems(),this.modeItem(2),this.current.select=!0)}resetItems(){let t=this.items.length;for(;t--;)this.items[t].select=!1,this.items[t].style.background=this.colors.back,this.items[t].style.color=this.colors.text}hideActive(){this.hideCurrent&&(this.current&&(this.tmpId=this.current.id),this.resetHide())}resetHide(){console.log(this.tmpId);let t=this.items.length;for(;t--;)t===this.tmpId?(this.items[t].style.height="0px",this.items[t].posy=-1):(this.items[t].style.height=this.itemHeight+"px",this.items[t].posy=(this.itemHeight+1)*(t-1))}mouseup(t){this.isDown=!1}mousedown(t){let s=this.testZone(t);return!!s&&(s==="scroll"?(this.isDown=!0,this.mousemove(t)):s==="title"?(this.modeTitle(2),this.listOnly||(this.hideActive(),this.isOpen?this.close():this.open())):this.current&&(this.value=this.list[this.current.id],this.isSelectable&&this.selected(),this.send(this.value),this.listOnly||(this.close(),this.setTopItem())),!0)}mousemove(t){let s=!1,i=this.testZone(t);if(!i)return s;if(i==="title")this.unSelected(),this.modeTitle(1),this.cursor("pointer");else if(i==="scroll"){if(this.cursor("s-resize"),this.modeScroll(1),this.isDown){this.modeScroll(2);let h=this.zone.y+this.baseH-2;this.update(t.clientY-h-.5*this.sh)}}else this.modeTitle(0),this.modeScroll(0),this.cursor("pointer");return i!==this.prevName&&(s=!0),this.prevName=i,s}wheel(t){return this.testZone(t)!=="title"&&(this.py+=10*t.delta,this.update(this.py),!0)}reset(){this.prevName="",this.unSelected(),this.modeTitle(0),this.modeScroll(0)}modeScroll(t){if(t===this.sMode)return;let s=this.scroller.style,i=this.colors;switch(t){case 0:s.background=i.text;break;case 1:case 2:s.background=i.select}this.sMode=t}modeTitle(t){if(t===this.tMode)return;let s=this.s,i=this.colors;switch(t){case 0:s[3].color=i.text,s[3].background=i.button;break;case 1:s[3].color=i.textOver,s[3].background=i.overoff;break;case 2:s[3].color=i.textSelect,s[3].background=i.overoff}this.tMode=t}clearList(){for(;this.listIn.children.length;)this.listIn.removeChild(this.listIn.lastChild);this.items=[]}setList(t){this.clearList(),this.list=t,this.length=this.list.length;let s,i,h=this.hideCurrent?this.length-1:this.length;this.maxItem=this.full?h:5,this.maxItem=h<this.maxItem?h:this.maxItem,this.maxHeight=this.maxItem*(this.itemHeight+1)+2,this.max=h*(this.itemHeight+1)+2,this.ratio=this.maxHeight/this.max,this.sh=this.maxHeight*this.ratio,this.range=this.maxHeight-this.sh,this.c[2].style.height=this.maxHeight+"px",this.scrollerBack.style.height=this.maxHeight+"px",this.scroller.style.height=this.sh+"px",this.max>this.maxHeight&&(this.ww=this.sb-this.ss,this.scroll=!0),this.miniCanvas&&(this.tmpCanvas=document.createElement("canvas"),this.tmpCanvas.width=this.imageSize[0],this.tmpCanvas.height=this.imageSize[1],this.tmpCtx=this.tmpCanvas.getContext("2d"),this.tmpCtx.fillStyle=this.canvasBg,this.tmpCtx.fillRect(0,0,this.imageSize[0],this.imageSize[1]));for(let o=0;o<this.length;o++){if(i=this.list[o],s=this.dom("div",this.css.item+"padding:0px "+(this.m+1)+"px; width:"+this.ww+"px; height:"+this.itemHeight+"px; line-height:"+(this.itemHeight-2)+"px; color:"+this.colors.text+"; background:"+this.colors.back+";"),s.name="item"+o,s.id=o,s.select=!1,s.posy=(this.itemHeight+1)*o,this.listIn.appendChild(s),this.items.push(s),i===this.value&&(this.current=s),this.isWithImage||(s.textContent=i),this.miniCanvas){let r=new Image;r.src=this.tmpCanvas.toDataURL(),r.style.cssText="margin-right:4px;",s.appendChild(r),this.tmpImage[i]=r}this.dragout&&(s.img=this.tmpImage[i],s.style.pointerEvents="auto",s.draggable="true",s.addEventListener("dragstart",this.dragstart||function(){}),s.addEventListener("drag",this.drag||function(){}),s.addEventListener("dragleave",function(){u.fakeUp()}),s.addEventListener("dragend",this.dragend||(function(){}).bind(this)))}this.setTopItem(),this.isSelectable&&this.selected()}drawImage(t,s,i,h,o,r){this.tmpCtx.clearRect(0,0,this.imageSize[0],this.imageSize[1]),this.tmpCtx.drawImage(s,i,h,o,r,0,0,this.imageSize[0],this.imageSize[1]),this.tmpImage[t].src=this.tmpCanvas.toDataURL()}addImages(){let t=this.list.length;for(let s=0;s<t;s++)this.items[s].appendChild(this.tmpImage[this.list[s]]);this.setTopItem()}setValue(t){isNaN(t)?this.value=t:this.value=this.list[t],this.setTopItem()}setTopItem(){if(!this.staticTop){if(this.isWithImage){if(!this.preLoadComplete)return;this.c[3].children.length||(this.canvas=document.createElement("canvas"),this.canvas.width=this.imageSize[0],this.canvas.height=this.imageSize[1],this.canvas.style.cssText="margin-right:4px;",this.ctx=this.canvas.getContext("2d"),this.c[3].style.textAlign="left",this.c[3].style.justifyContent="left",this.c[3].appendChild(this.canvas)),this.tmpImage[this.value],this.ctx.drawImage(this.tmpImage[this.value],0,0,this.imageSize[2],this.imageSize[3],0,0,this.imageSize[0],this.imageSize[1])}else this.c[3].textContent=this.value;this.miniCanvas&&(this.c[3].children.length||(this.canvas=document.createElement("canvas"),this.canvas.width=this.imageSize[0],this.canvas.height=this.imageSize[1],this.canvas.style.cssText="margin-right:4px;",this.ctx=this.canvas.getContext("2d"),this.c[3].style.textAlign="left",this.c[3].style.justifyContent="left",this.c[3].appendChild(this.canvas)),this.ctx.drawImage(this.tmpImage[this.value],0,0))}}update(t){this.scroll&&(t=(t=t<0?0:t)>this.range?this.range:t,this.topList=-Math.floor(t/this.ratio),this.listIn.style.top=this.topList+"px",this.scroller.style.top=Math.floor(t)+"px",this.py=t)}parentHeight(t){this.group!==null?this.group.calc(t):this.isUI&&this.main.calc(t)}open(t){super.open(),this.update(0),this.h=this.maxHeight+this.baseH+5,this.scroll?(this.scroller.style.display="block",this.scrollerBack.style.display="block"):(this.topList=0,this.h=this.baseH+5+this.max,this.scroller.style.display="none",this.scrollerBack.style.display="none"),this.s[0].height=this.h+"px",this.s[2].display="block",this.up?(this.zone.y-=this.h-(this.baseH-10),this.setSvg(this.c[4],"d",this.svgs.g1)):this.setSvg(this.c[4],"d",this.svgs.g2),this.rSizeContent();let s=this.h-this.baseH;this.zone.h=this.h,t||this.parentHeight(s)}close(){super.close(),this.up&&(this.zone.y+=this.h-(this.baseH-10));let t=this.h-this.baseH;this.h=this.baseH,this.s[0].height=this.h+"px",this.s[2].display="none",this.setSvg(this.c[4],"d",this.svgs.g1),this.zone.h=this.h,this.parentHeight(-t)}text(t){this.c[3].textContent=t}rSizeContent(){let t=this.length;for(;t--;)this.listIn.children[t].style.width=this.ww+"px"}rSize(){super.rSize();let t=this.s,s=this.sb,i=this.sa;t[2]!==void 0&&(t[2].width=s+"px",t[2].left=i+"px",t[3].width=s+"px",t[3].left=i+"px",t[4].left=i+s-15+"px",this.ww=s,this.max>this.maxHeight&&(this.ww=s-this.ss),this.isOpen&&this.rSizeContent())}}class U extends v{constructor(t={}){super(t),this.setTypeNumber(t),this.allway=t.allway||!1,this.isDown=!1,this.value=[0],this.multy=1,this.invmulty=1,this.isSingle=!0,this.isAngle=!1,this.isVector=!1,t.isAngle&&(this.isAngle=!0,this.multy=a.torad,this.invmulty=a.todeg),this.isDrag=t.drag||!1,t.value!==void 0&&(isNaN(t.value)?t.value instanceof Array?(this.value=t.value,this.isSingle=!1):t.value instanceof Object&&(this.value=[],t.value.x!==void 0&&(this.value[0]=t.value.x),t.value.y!==void 0&&(this.value[1]=t.value.y),t.value.z!==void 0&&(this.value[2]=t.value.z),t.value.w!==void 0&&(this.value[3]=t.value.w),this.isSingle=!1,this.isVector=!0):this.value=[t.value]),this.lng=this.value.length,this.tmp=[],this.current=-1,this.prev={x:0,y:0,d:0,v:0};let s=this.colors;this.c[2]=this.dom("div",this.css.basic+" background:"+s.select+"; top:4px; width:0px; height:"+(this.h-8)+"px;"),this.cMode=[];let i=this.lng;for(;i--;)this.isAngle&&(this.value[i]=(180*this.value[i]/Math.PI).toFixed(this.precision)),this.c[3+i]=this.dom("div",this.css.txtselect+"top:1px; height:"+(this.h-2)+"px; color:"+s.text+"; background:"+s.back+"; borderColor:"+s.border+"; border-radius:"+this.radius+"px;"),t.center&&(this.c[2+i].style.textAlign="center"),this.c[3+i].textContent=this.value[i],this.c[3+i].style.color=this.colors.text,this.c[3+i].isNum=!0,this.cMode[i]=0;this.selectId=3+this.lng,this.c[this.selectId]=this.dom("div",this.css.txtselect+"position:absolute; top:2px; height:"+(this.h-4)+"px; padding:0px 0px; width:0px; color:"+s.textSelect+"; background:"+s.select+"; border:none; border-radius:0px;"),this.cursorId=4+this.lng,this.c[this.cursorId]=this.dom("div",this.css.basic+"top:2px; height:"+(this.h-4)+"px; width:0px; background:"+s.text+";"),this.init()}testZone(t){let s=this.local;if(s.x===-1&&s.y===-1)return"";let i=this.lng,h=this.tmp;for(;i--;)if(s.x>h[i][0]&&s.x<h[i][2])return i;return""}mousedown(t){let s=this.testZone(t);return!this.isDown&&(this.isDown=!0,s!==""&&(this.current=s,this.prev={x:t.clientX,y:t.clientY,d:0,v:this.isSingle?parseFloat(this.value):parseFloat(this.value[this.current])},this.setInput(this.c[3+this.current])),this.mousemove(t))}mouseup(t){return!!this.isDown&&(this.isDown=!1,this.prev={x:0,y:0,d:0,v:0},this.mousemove(t))}mousemove(t){let s=!1,i=0;if(this.testZone(t)===""?this.cursor():this.isDrag?this.cursor(this.current!==-1?"move":"pointer"):this.cursor("text"),!this.isDrag)return this.isDown&&(i=t.clientX-this.zone.x-3),this.current!==-1&&(i-=this.tmp[this.current][0]),this.upInput(i,this.isDown);if(this.current!==-1){this.prev.d+=t.clientX-this.prev.x-(t.clientY-this.prev.y);let h=this.prev.v+this.prev.d*this.step;this.value[this.current]=this.numValue(h),this.c[3+this.current].textContent=this.value[this.current],this.validate(),this.prev.x=t.clientX,this.prev.y=t.clientY,s=!0}return s}reset(){return!1}setValue(t){this.isVector?(t.x!==void 0&&(this.value[0]=t.x),t.y!==void 0&&(this.value[1]=t.y),t.z!==void 0&&(this.value[2]=t.z),t.w!==void 0&&(this.value[3]=t.w)):this.value=this.isSingle?[t]:t,this.update()}sameStr(t){let s=this.value.length;for(;s--;)this.c[3+s].textContent=t}update(t){let s=this.value.length;for(;s--;)this.value[s]=this.numValue(this.value[s]*this.invmulty),this.c[3+s].textContent=this.value[s];t&&this.send()}send(t){t=t||this.value,this.isSend=!0,this.objectLink!==null&&(this.isVector?this.objectLink[this.objectKey].fromArray(t):this.objectLink[this.objectKey]=t),this.callback&&this.callback(t,this.objectKey),this.isSend=!1}select(t,s,i,h){let o=this.s,r=this.current!==-1?this.tmp[this.current][0]+5:0;o[this.cursorId].width="1px",o[this.cursorId].left=r+t+"px",o[this.selectId].left=r+s+"px",o[this.selectId].width=i+"px",this.c[this.selectId].innerHTML=h}unselect(){let t=this.s;t&&(this.c[this.selectId].innerHTML="",t[this.selectId].width="0px",t[this.cursorId].width="0px")}validate(t){let s=[],i=this.lng;for(this.allway&&(t=!0);i--;){if(isNaN(this.c[3+i].textContent))this.c[3+i].textContent=this.value[i];else{let h=this.numValue(this.c[3+i].textContent);this.c[3+i].textContent=h,this.value[i]=h}s[i]=this.value[i]*this.multy}t&&this.send(this.isSingle?s[0]:s)}rSize(){super.rSize();let t=this.colors.sx,s=t*(this.lng-1),i=(this.sb-s)/this.lng,h=this.s,o=this.lng;for(;o--;)this.tmp[o]=[this.sa+i*o+t*o,i],this.tmp[o][2]=this.tmp[o][0]+this.tmp[o][1],h[3+o].left=this.tmp[o][0]+"px",h[3+o].width=this.tmp[o][1]+"px"}}class B extends v{constructor(t={}){super(t),this.setTypeNumber(t),this.model=t.stype||0,t.mode!==void 0&&(this.model=t.mode),this.isDown=!1,this.isOver=!1,this.allway=t.allway||!1,this.isDeg=t.isDeg||!1,this.isCyclic=t.cyclic||!1,this.firstImput=!1;let s=this.colors;if(this.c[2]=this.dom("div",this.css.txtselect+"border:none; background:none; width:47px; color:"+s.text+";"),this.c[3]=this.dom("div",this.css.basic+" top:0; height:"+this.h+"px;"),this.c[4]=this.dom("div",this.css.basic+"background:"+s.back+"; top:2px; height:"+(this.h-4)+"px;"),this.c[5]=this.dom("div",this.css.basic+"left:4px; top:5px; height:"+(this.h-10)+"px; background:"+s.text+";"),this.c[2].isNum=!0,this.c[2].style.height=this.h-2+"px",this.c[2].style.lineHeight=this.h-10+"px",this.model!==0){let i=4,h=4,o=8,r=this.h-6,c=16;this.model===2&&(i=0,h=2,o=4,c=2,r=.5*(this.h-6)),this.model===3&&(this.c[5].style.visible="none"),this.c[4].style.borderRadius=i+"px",this.c[4].style.height=o+"px",this.c[4].style.top=.5*this.h-h+"px",this.c[5].style.borderRadius=.5*i+"px",this.c[5].style.height=h+"px",this.c[5].style.top=.5*this.h-.5*h+"px",this.c[6]=this.dom("div",this.css.basic+"border-radius:"+c+"px; margin-left:"+.5*-r+"px; background:"+s.text+"; left:4px; top:3px; height:"+(this.h-6)+"px; width:"+r+"px;")}this.init()}testZone(t){let s=this.local;return s.x===-1&&s.y===-1?"":s.x>=this.txl?"text":s.x>=this.sa?"scroll":""}mouseup(t){this.isDown&&(this.isDown=!1)}mousedown(t){let s=this.testZone(t);return!!s&&(s==="scroll"&&(this.isDown=!0,this.old=this.value,this.mousemove(t)),!0)}mousemove(t){let s=!1;if(this.testZone(t)==="scroll"?(this.mode(1),this.cursor("w-resize")):this.cursor(),this.isDown){let i=(t.clientX-(this.zone.x+this.sa)-3)/this.ww*this.range+this.min-this.old;(i>=this.step||i<=this.step)&&(i=Math.floor(i/this.step),this.value=this.numValue(this.old+i*this.step),this.update(!0),this.old=this.value),s=!0}return s}wheel(t){if(this.testZone(t)==="scroll"){let s=this.value-this.step*t.delta;return s>this.max?s=this.isCyclic?this.min:this.max:s<this.min&&(s=this.isCyclic?this.max:this.min),this.setValue(s),this.old=s,this.update(!0),!0}return!1}validate(){let t=this.c[2].textContent;isNaN(t)?this.c[2].textContent=this.value+(this.isDeg?"°":""):(this.value=this.numValue(t),this.update(!0))}reset(){this.isDown=!1,this.mode(0)}mode(t){let s=this.s,i=this.colors;switch(t){case 0:s[2].color=i.text,s[4].background=i.back,s[5].background=i.text,this.model!==0&&(s[6].background=i.text);break;case 1:s[2].color=i.textOver,s[4].background=i.back,s[5].background=i.textOver,this.model!==0&&(s[6].background=i.textOver)}}update(t){let s=Math.floor(this.ww*((this.value-this.min)/this.range));this.model!==3&&(this.s[5].width=s+"px"),this.s[6]&&(this.s[6].left=this.sa+s+3+"px"),this.c[2].textContent=this.value+(this.isDeg?"°":""),t&&this.send()}rSize(){super.rSize();let t=this.sb-this.sc;this.ww=t-6;let s=this.sc;!this.isUI&&this.simple||(s=this.sc+10),this.txl=this.w-s+2;let i=this.s;i[2].width=this.sc-6+"px",i[2].left=this.txl+4+"px",i[3].left=this.sa+"px",i[3].width=t+"px",i[4].left=this.sa+"px",i[4].width=t+"px",i[5].left=this.sa+3+"px",this.update()}}class Q extends v{constructor(t={}){super(t),this.cmode=0,this.value=t.value!==void 0?t.value:"",this.placeHolder=t.placeHolder||"",this.allway=t.allway||!1,this.editable=t.edit===void 0||t.edit,this.isDown=!1;let s=this.colors;this.c[2]=this.dom("div",this.css.txtselect+"top:1px; height:"+(this.h-2)+"px; color:"+s.text+"; background:"+s.back+"; borderColor:"+s.border+"; border-radius:"+this.radius+"px;"),this.c[2].textContent=this.value,this.c[3]=this.dom("div",this.css.txtselect+"position:absolute; top:2px; height:"+(this.h-4)+"px; padding:0px 0px; width:0px; color:"+s.textSelect+"; background:"+s.select+"; border:none; border-radius:0px;"),this.c[4]=this.dom("div",this.css.basic+"top:2px; height:"+(this.h-4)+"px; width:0px; background:"+s.text+";"),this.c[5]=this.dom("div",this.css.txtselect+"top:1px; height:"+(this.h-2)+"px; border:none; justify-content: center; font-style: italic; color:"+s.border+";"),this.value===""&&(this.c[5].textContent=this.placeHolder),this.init()}testZone(t){let s=this.local;return s.x===-1&&s.y===-1?"":s.x>=this.sa?"text":""}mouseup(t){if(this.editable)return!!this.isDown&&(this.isDown=!1,this.mousemove(t))}mousedown(t){if(!this.editable)return;let s=this.testZone(t);return!this.isDown&&(this.isDown=!0,s==="text"&&this.setInput(this.c[2]),this.mousemove(t))}mousemove(t){if(!this.editable)return;let s=0;return this.testZone(t)==="text"?this.cursor("text"):this.cursor(),this.isDown&&(s=t.clientX-this.zone.x),this.upInput(s-this.sa-3,this.isDown)}update(){this.c[2].textContent=this.value}reset(){this.cursor()}select(t,s,i,h){let o=this.s,r=this.sa+5;o[4].width="1px",o[4].left=r+s+"px",o[3].left=r+s+"px",o[3].width=i+"px",this.c[3].innerHTML=h}unselect(){let t=this.s;t&&(t[3].width="0px",this.c[3].innerHTML="t",t[4].width="0px")}validate(t){this.allway&&(t=!0),this.value=this.c[2].textContent,this.value!==""?this.c[5].textContent="":this.c[5].textContent=this.placeHolder,t&&this.send()}rSize(){super.rSize();let t=this.s;t[2].left=this.sa+"px",t[2].width=this.sb+"px",t[5].left=this.sa+"px",t[5].width=this.sb+"px"}}class W extends v{constructor(t={}){super(t);let s=t.prefix||"";this.c[2]=this.dom("div",this.css.txt+"justify-content:right; width:60px; line-height:"+(this.h-8)+"px; color:"+this.colors.text),this.h===31&&(this.s[0].height=this.h+"px",this.s[1].top="8px",this.c[2].style.top="8px");let i=this.s;i[1].justifyContent=t.align||"left",i[1].fontWeight=t.fontWeight||"bold",this.c[1].textContent=this.txt.substring(0,1).toUpperCase()+this.txt.substring(1).replace("-"," "),this.c[2].textContent=s,this.init()}text(t){this.c[1].textContent=t}text2(t){this.c[2].textContent=t}rSize(){super.rSize(),this.s[1].width=this.w+"px",this.s[2].left=this.w+"px"}setColor(t){this.s[1].color=t,this.s[2].color=t}}class V extends v{constructor(t={}){super(t),this.value=t.value||"",this.isDown=!1,this.onActif=t.onActif||function(){};const s=this.colors;this.c[2]=this.dom("div",this.css.txt+this.css.button+" top:1px; background:"+s.button+"; height:"+(this.h-2)+"px; border:"+s.buttonBorder+"; border-radius:15px; width:30px; left:10px;"),this.c[3]=this.dom("div",this.css.txtselect+"height:"+(this.h-4)+"px; background:"+s.inputBg+"; borderColor:"+s.inputBorder+"; border-radius:"+this.radius+"px;"),this.c[3].textContent=this.value;let i=Math.floor(.5*this.h)-7;this.c[4]=this.dom("path",this.css.basic+"position:absolute; width:14px; height:14px; left:5px; top:"+i+"px;",{d:this.svgs.cursor,fill:s.text,stroke:"none"}),this.stat=1,this.isActif=!1,this.init()}testZone(t){let s=this.local;return s.x===-1&&s.y===-1?"":s.x>this.sa&&s.x<this.sa+30?"over":"0"}mouseup(t){return!!this.isDown&&(this.isDown=!1,this.mousemove(t))}mousedown(t){return!!this.testZone(t)&&(this.isDown=!0,this.mousemove(t))}mousemove(t){let s=!1;return this.testZone(t)==="over"?(this.cursor("pointer"),s=this.mode(this.isDown?3:2)):s=this.reset(),s}apply(t){(t=t||"")!==this.value&&(this.value=t,this.c[3].textContent=this.value,this.send()),this.mode(1)}update(){this.mode(3)}mode(t){let s=!1,i=this.colors;if(this.stat!==t){switch(t===1&&(this.isActif=!1),t===3&&(this.isActif?this.isActif=!1:(this.isActif=!0,t=4,this.onActif(this))),t===2&&this.isActif&&(t=4),this.stat=t,t){case 1:this.s[2].color=i.text,this.s[2].background=i.button;break;case 2:this.s[2].color=i.textOver,this.s[2].background=i.overoff;break;case 3:this.s[2].color=i.textOver,this.s[2].background=i.action;break;case 4:this.s[2].color=i.textSelect,this.s[2].background=i.action}s=!0}return s}reset(){return this.cursor(),this.mode(this.isActif?4:1)}text(t){this.c[3].textContent=t}rSize(){super.rSize();let t=this.s;t[2].left=this.sa+"px",t[3].left=this.sa+40+"px",t[3].width=this.sb-40+"px",t[4].left=this.sa+8+"px"}}class X extends v{constructor(t={}){super(t),this.value=t.value||"",this.refTexture=t.texture||null,this.img=null,this.isDown=!1,this.neverlock=!0;const s=this.colors;this.c[2]=this.dom("div",this.css.txt+this.css.button+" top:1px; background:"+s.button+"; height:"+(this.h-2)+"px; border:"+s.buttonBorder+"; border-radius:15px; width:30px; left:10px;"),this.c[3]=this.dom("div",this.css.txtselect+"height:"+(this.h-4)+"px; background:"+s.inputBg+"; borderColor:"+s.inputBorder+"; border-radius:"+this.radius+"px;"),this.c[3].textContent=this.value;let i=Math.floor(.5*this.h)-7;this.c[4]=this.dom("path",this.css.basic+"position:absolute; width:14px; height:14px; left:5px; top:"+i+"px;",{d:this.svgs.load,fill:s.text,stroke:"none"}),this.stat=1,this.init()}testZone(t){let s=this.local;return s.x===-1&&s.y===-1?"":s.x>this.sa&&s.x<this.sa+30?"over":"0"}mouseup(t){return!!this.isDown&&(this.isDown=!1,this.mousemove(t))}mousedown(t){let s=this.testZone(t);return!!s&&(s==="over"&&(this.isDown=!0,I.load({callback:this.changeBitmap.bind(this)})),this.mousemove(t))}mousemove(t){let s=!1;return this.testZone(t)==="over"?(this.cursor("pointer"),s=this.mode(this.isDown?3:2)):s=this.reset(),s}changeBitmap(t,s){t?(this.img=t,this.apply(s)):(this.img=null,this.apply("null"))}apply(t){(t=t||"")!==this.value&&(this.value=t,this.c[3].textContent=this.value,this.img!==null&&(this.objectLink!==null&&(this.objectLink[this.val]=t),this.callback&&this.callback(this.value,this.img,this.name))),this.mode(1)}update(){this.mode(3)}mode(t){let s=!1,i=this.colors;if(this.stat!==t){switch(this.stat=t,t){case 1:this.s[2].color=i.text,this.s[2].background=i.button;break;case 2:this.s[2].color=i.textOver,this.s[2].background=i.overoff;break;case 3:this.s[2].color=i.textOver,this.s[2].background=i.over;break;case 4:this.s[2].color=i.textSelect,this.s[2].background=i.select}s=!0}return s}reset(){return this.cursor(),this.mode(this.isActif?4:1)}text(t){this.c[3].textContent=t}rSize(){super.rSize();let t=this.s;t[2].left=this.sa+"px",t[3].left=this.sa+40+"px",t[3].width=this.sb-40+"px",t[4].left=this.sa+8+"px"}}class Y extends z{constructor(t={}){t.selectable===void 0&&(t.selectable=!0),super(t)}}class _ extends v{constructor(t={}){super(t),this.p=100,this.value=this.txt,this.status=1,this.itype=t.itype||"none",this.val=this.itype,this.graph=this.svgs[this.itype];let s=Math.floor(.5*this.h)-7;this.c[2]=this.dom("path",this.css.basic+"position:absolute; width:14px; height:14px; left:5px; top:"+s+"px;",{d:this.graph,fill:this.colors.text,stroke:"none"}),this.s[1].marginLeft="20px",this.init()}mousemove(t){this.cursor("pointer")}mousedown(t){return this.isUI&&this.main.resetItem(),this.selected(!0),this.send(),!0}uiout(){this.isSelect?this.mode(3):this.mode(1)}uiover(){this.isSelect?this.mode(4):this.mode(2)}update(){}mode(t){let s=!1;if(this.status!==t){this.status=t;let i=this.s,h=this.colors;switch(t){case 1:this.status=1,i[1].color=h.text,i[0].background="none";break;case 2:this.status=2,i[1].color=h.textOver,i[0].background=h.back;break;case 3:this.status=3,i[1].color=h.textSelect,i[0].background=h.select;break;case 4:this.status=4,i[1].color=h.textOver,i[0].background=h.over}s=!0}return s}reset(){this.cursor()}selected(t){this.isSelect&&this.mode(1),this.isSelect=t||!1,this.isSelect&&this.mode(3)}}class K extends v{constructor(t={}){if(super(t),this.values=[],t.values){if(t.values instanceof Array)this.values=t.values;else if(t.values instanceof String)this.values=[t.values];else if(t.values instanceof Object){this.refObject=t.values;for(let d in this.refObject)this.values.push(d)}}this.lng=this.values.length,this.value=t.value||null;let s=this.colors;this.isSelectable=t.selectable||!1,this.spaces=t.spaces||[s.sx,s.sy],this.bsize=t.bsize||[90,this.h],this.bsizeMax=this.bsize[0],this.tmp=[],this.stat=[],this.grid=[2,Math.round(.5*this.lng)],this.h=this.grid[1]*this.bsize[1]+this.grid[1]*this.spaces[1],this.c[1].textContent="",this.c[2]=this.dom("table",this.css.basic+"width:100%; border-spacing: "+(this.spaces[0]-2)+"px "+this.spaces[1]+"px; border:none;");let i,h,o,r,c=0;this.res=-1,this.isDown=!1,this.neverlock=!0,this.buttons=[],this.stat=[],this.tmpX=[],this.tmpY=[];for(let d=0;d<this.grid[1];d++){o=this.c[2].insertRow(),o.style.cssText="pointer-events:none;";for(let m=0;m<this.grid[0];m++)h=o.insertCell(),h.style.cssText="pointer-events:none;",this.values[c]?(r=!1,this.values[c]===this.value&&this.isSelectable&&(r=!0),i=document.createElement("div"),i.style.cssText=this.css.txt+this.css.button+"position:static; top:1px; width:"+this.bsize[0]+"px; height:"+(this.bsize[1]-2)+"px; border:"+s.borderSize+"px solid "+s.border+"; left:auto; right:auto; border-radius:"+this.radius+"px;",i.style.background=r?s.select:s.button,i.style.color=r?s.textSelect:s.text,i.innerHTML=this.values[c],h.appendChild(i),this.buttons.push(i),this.stat.push(1)):(i=document.createElement("div"),i.style.cssText=this.css.txt+"position:static; width:"+this.bsize[0]+"px; height:"+this.bsize[1]+"px; text-align:center; left:auto; right:auto; background:none;",h.appendChild(i)),i.style.cssText+=m===0?"float:right;":"float:left;",c++}this.s[0].border="none",this.init()}testZone(t){let s=this.local;if(s.x===-1&&s.y===-1)return-1;s.y+=this.mtop;let i=this.tmpX,h=this.tmpY,o=-1,r=-1,c=-1,d=this.grid[0];for(;d--;)s.x>i[d][0]&&s.x<i[d][1]&&(r=d);for(d=this.grid[1];d--;)s.y>h[d][0]&&s.y<h[d][1]&&(c=d);return r!==-1&&c!==-1&&(o=r+2*c,o>this.lng-1&&(o=-1)),o}mouseup(t){return!!this.isDown&&(this.isDown=!1,this.res!==-1&&(this.value=this.values[this.res],this.send()),this.mousemove(t))}mousedown(t){return!this.isDown&&(this.isDown=!0,this.mousemove(t))}mousemove(t){let s=!1;return this.res=this.testZone(t),this.res!==-1?(this.cursor("pointer"),s=this.modes(this.isDown?3:2,this.res)):s=this.reset(),s}modes(t=1,s=-1){let i,h,o=this.lng,r=!1;for(;o--;)h=t,i=!!this.isSelectable&&this.values[o]===this.value,o===s?i&&h===2&&(h=3):(h=1,i&&(h=4)),this.mode(h,o)&&(r=!0);return r}mode(t,s){let i=!1,h=this.colors,o=this.buttons,r=s;if(this.stat[s]!==t){switch(this.stat[s]=t,t){case 1:o[r].style.color=h.text,o[r].style.background=h.button;break;case 2:o[r].style.color=h.textOver,o[r].style.background=h.overoff;break;case 3:o[r].style.color=h.textOver,o[r].style.background=h.over;break;case 4:o[r].style.color=h.textSelect,o[r].style.background=h.select}i=!0}return i}reset(){return this.res=-1,this.cursor(),this.modes()}label(t,s){this.buttons[s].textContent=t}icon(t,s,i){this.buttons[i].style.padding=(s||0)+"px 0px",this.buttons[i].innerHTML=t}testW(){let t=!1;if(3*this.spaces[0]+2*this.bsizeMax>this.w?(this.bsize[0]=.5*(this.w-3*this.spaces[0]),t=!0):this.bsize[0]!==this.bsizeMax&&(this.bsize[0]=this.bsizeMax,t=!0),!t)return;let s=this.buttons.length;for(;s--;)this.buttons[s].style.width=this.bsize[0]+"px"}rSize(){let t;super.rSize(),this.testW(),this.tmpX=[],this.tmpY=[];for(let s=0;s<this.grid[0];s++)s===0?(t=.5*this.w-.5*this.spaces[0],this.tmpX.push([t-this.bsize[0],t])):(t=.5*this.w+.5*this.spaces[0],this.tmpX.push([t,t+this.bsize[0]]));t=this.spaces[1];for(let s=0;s<this.grid[1];s++)this.tmpY.push([t,t+this.bsize[1]]),t+=this.bsize[1]+this.spaces[1]}}class q extends v{constructor(t={}){super(t),this.autoWidth=!1,this.minw=this.w,this.diam=t.diam||this.w,this.pos=new w(0,0),this.maxPos=90,this.model=t.stype||0,t.mode!==void 0&&(this.model=t.mode),this.min=t.min===void 0?-1:t.min,this.max=t.max===void 0?1:t.max,this.range=.5*(this.max-this.min),this.cmode=0,this.c[0].style.display="block",this.precision=t.precision===void 0?2:t.precision,this.value=Array.isArray(t.value)&&t.value.length==2?t.value:[0,0],this.h=t.h||this.w+10,this.c[0].style.width=this.w+"px",this.c[1]!==void 0&&(this.c[1].style.width="100%",this.c[1].style.justifyContent="center",this.top=10,this.h+=10);let s=this.colors;this.c[2]=this.dom("div",this.css.txt+"justify-content:center; top:"+(this.h-20)+"px; width:100%; color:"+s.text),this.c[2].textContent=this.value;let i=this.getPad2d();this.setSvg(i,"fill",s.back,0),this.setSvg(i,"fill",s.button,1),this.setSvg(i,"stroke",s.back,2),this.setSvg(i,"stroke",s.back,3),this.setSvg(i,"stroke",s.text,4),this.setSvg(i,"viewBox","0 0 "+this.diam+" "+this.diam),this.setCss(i,{width:this.diam,height:this.diam,left:0,top:this.top}),this.c[3]=i,this.init(),this.setValue()}testZone(t){let s=this.local;return s.x===-1&&s.y===-1?"":s.y<=this.c[1].offsetHeight?"title":s.y>this.h-this.c[2].offsetHeight?"text":"pad"}mouseup(t){return this.isDown=!1,this.mode(0)}mousedown(t){if(this.testZone(t)==="pad")return this.isDown=!0,this.mousemove(t),this.mode(1)}mousemove(t){if(!this.isDown)return;let s=.5*this.w-(t.clientX-this.zone.x),i=.5*this.diam-(t.clientY-this.zone.y-this.ytop),h=256/this.diam;s=-s*h,i=-i*h,s=a.clamp(s,-this.maxPos,this.maxPos),i=a.clamp(i,-this.maxPos,this.maxPos),this.setPos([s,i]),this.update(!0)}mode(t){if(this.cmode===t)return!1;let s=this.colors;switch(t){case 0:this.s[2].color=s.text,this.setSvg(this.c[3],"fill",s.back,0),this.setSvg(this.c[3],"fill",s.button,1),this.setSvg(this.c[3],"stroke",s.back,2),this.setSvg(this.c[3],"stroke",s.back,3),this.setSvg(this.c[3],"stroke",s.text,4);break;case 1:this.s[2].color=s.textSelect,this.setSvg(this.c[3],"fill",s.backoff,0),this.setSvg(this.c[3],"fill",s.overoff,1),this.setSvg(this.c[3],"stroke",s.backoff,2),this.setSvg(this.c[3],"stroke",s.backoff,3),this.setSvg(this.c[3],"stroke",s.textSelect,4)}return this.cmode=t,!0}update(t){this.c[2].textContent=this.value,this.updateSVG(),t&&this.send()}updateSVG(){this.model==1&&(this.setSvg(this.c[3],"y1",this.pos.y,2),this.setSvg(this.c[3],"y2",this.pos.y,2),this.setSvg(this.c[3],"x1",this.pos.x,3),this.setSvg(this.c[3],"x2",this.pos.x,3)),this.setSvg(this.c[3],"cx",this.pos.x,4),this.setSvg(this.c[3],"cy",this.pos.y,4)}setPos(t){this.pos.set(t[0]+128,t[1]+128);let s=1/this.maxPos;this.value[0]=(t[0]*s*this.range).toFixed(this.precision),this.value[1]=(t[1]*s*this.range).toFixed(this.precision)}setValue(t,s=!1){t===void 0&&(t=this.value),this.value[0]=1*Math.min(this.max,Math.max(this.min,t[0])).toFixed(this.precision),this.value[1]=1*Math.min(this.max,Math.max(this.min,t[1])).toFixed(this.precision),this.pos.set(this.value[0]/this.range*this.maxPos+128,this.value[1]/this.range*this.maxPos+128),this.update(s)}}const O=function(){let e,t,s=arguments,i=!1,h=null;typeof s[0]=="string"?(e=s[0],t=s[1]||{}):typeof s[0]=="object"&&(i=!0,s[2]===void 0&&[].push.call(s,{}),e=s[2].type?s[2].type:J(s[0][s[1]],s[2]),t=s[2],t.name=s[1],e!=="list"||t.list?t.value=s[0][s[1]]:t.list=s[0][s[1]]);let o=e.toLowerCase();switch(o==="group"&&(t.add=O),o){case"bool":case"boolean":h=new E(t);break;case"button":h=new z(t);break;case"circular":h=new P(t);break;case"color":h=new j(t);break;case"fps":h=new N(t);break;case"graph":h=new R(t);break;case"group":h=new Z(t);break;case"joystick":h=new F(t);break;case"knob":h=new A(t);break;case"list":h=new G(t);break;case"numeric":case"number":h=new U(t);break;case"slide":h=new B(t);break;case"textInput":case"string":h=new Q(t);break;case"title":case"text":h=new W(t);break;case"select":h=new V(t);break;case"bitmap":h=new X(t);break;case"selector":h=new Y(t);break;case"empty":case"space":h=new T(t);break;case"item":h=new _(t);break;case"grid":h=new K(t);break;case"pad2d":case"pad":h=new q(t)}if(h!==null)return u.needResize=!0,i&&h.setReferency(s[0],s[1]),h},J=function(e,t){let s="slide";return typeof e=="boolean"?s="bool":typeof e=="string"?s=e.substring(0,1)==="#"?"color":"string":typeof e=="number"?s=t.ctype?"color":"slide":typeof e=="array"&&e instanceof Array?typeof e[0]=="number"?s="number":typeof e[0]=="string"&&(s="list"):typeof e=="object"&&e instanceof Object&&(s=e.x!==void 0?"number":"list"),s};class ${constructor(t={}){this.isGui=!0,this.name="gui",this.canvas=null,this.screen=null,this.plane=t.plane||null,t.config&&(t.colors=t.config),t.colors?this.setConfig(t.colors):this.colors=a.defineColor(t),this.css=a.cloneCss(),this.isReset=!0,this.tmpAdd=null,this.isCanvas=t.isCanvas||!1,this.isCanvasOnly=!1,u.addDOMEventListeners=t.addDOMEventListeners||!1,this.callback=t.callback===void 0?null:t.callback,this.forceHeight=t.maxHeight||0,this.lockHeight=t.lockHeight||!1,this.isItemMode=t.itemMode!==void 0&&t.itemMode,this.cn="",this.size=a.size,t.p!==void 0&&(this.size.p=t.p),t.w!==void 0&&(this.size.w=t.w),t.h!==void 0&&(this.size.h=t.h),t.s!==void 0&&(this.size.s=t.s),this.size.h=this.size.h<11?11:this.size.h,this.local=new w().neg(),this.zone={x:0,y:0,w:this.size.w,h:0},this.mouse=new w().neg(),this.h=0,this.sw=0,this.margin=this.colors.sy,this.marginDiv=a.isDivid(this.margin),this.isWithClose=t.close===void 0||t.close,this.bh=this.isWithClose?this.size.h:0,this.autoResize=t.autoResize===void 0||t.autoResize,this.isCenter=t.center||!1,this.cssGui=t.css!==void 0?t.css:this.isCenter?"":"right:10px;",this.isOpen=t.open===void 0||t.open,this.isDown=!1,this.isScroll=!1,this.uis=[],this.current=-1,this.proto=null,this.isEmpty=!0,this.decal=0,this.ratio=1,this.oy=0,this.isNewTarget=!1;let s=this.colors;this.content=a.dom("div",this.css.basic+" width:0px; height:auto; top:0px; background:"+s.content+"; "+this.cssGui),this.innerContent=a.dom("div",this.css.basic+"width:100%; top:0; left:0; height:auto; overflow:hidden;"),this.content.appendChild(this.innerContent),this.useFlex=!0;let i=this.useFlex?"display:flex; flex-flow: row wrap;":"";this.inner=a.dom("div",this.css.basic+i+"width:100%; left:0; "),this.innerContent.appendChild(this.inner),this.scrollBG=a.dom("div",this.css.basic+"right:0; top:0; width:"+(this.size.s-1)+"px; height:10px; display:none; background:"+s.background+";"),this.content.appendChild(this.scrollBG),this.scroll=a.dom("div",this.css.basic+"background:"+s.button+"; right:2px; top:0; width:"+(this.size.s-4)+"px; height:10px;"),this.scrollBG.appendChild(this.scroll),this.bottomText=t.bottomText||["open","close"];let h=s.radius;this.bottom=a.dom("div",this.css.txt+"width:100%; top:auto; bottom:0; left:0; border-bottom-right-radius:"+h+"px; border-bottom-left-radius:"+h+"px; justify-content:center; height:"+this.bh+"px; line-height:"+(this.bh-5)+"px; color:"+s.text+";"),this.content.appendChild(this.bottom),this.bottom.textContent=this.isOpen?this.bottomText[1]:this.bottomText[0],this.bottom.style.background=s.background,this.parent=t.parent!==void 0?t.parent:null,this.parent=t.target!==void 0?t.target:this.parent,this.parent!==null||this.isCanvas||(this.parent=document.body),this.parent!==null&&this.parent.appendChild(this.content),this.isCanvas&&this.parent===null&&(this.isCanvasOnly=!0),this.isCanvasOnly?(this.content.style.left="0px",this.content.style.right="auto",t.transition=0):this.content.style.pointerEvents="auto",this.transition=t.transition!==void 0?t.transition:a.transition,this.transition&&setTimeout(this.addTransition.bind(this),1e3),this.setWidth(),this.isCanvas&&this.makeCanvas(),u.add(this)}triggerMouseDown(t,s){u.handleEvent({type:"pointerdown",clientX:t,clientY:s,delta:0,key:null,keyCode:NaN})}triggerMouseMove(){u.handleEvent({type:"pointermove",clientX:-1,clientY:-1,delta:0,key:null,keyCode:NaN})}triggerMouseUp(t,s){u.handleEvent({type:"pointerup",clientX:t,clientY:s,delta:0,key:null,keyCode:NaN})}setTop(t,s){this.content.style.top=t+"px",s!==void 0&&(this.forceHeight=s),this.calc(),u.needReZone=!0}addTransition(){this.transition&&!this.isCanvas&&(this.innerContent.style.transition="height "+this.transition+"s ease-out",this.content.style.transition="height "+this.transition+"s ease-out",this.bottom.style.transition="top "+this.transition+"s ease-out");let t=this.uis.length;for(;t--;)this.uis[t].addTransition()}onDraw(){}makeCanvas(){this.canvas=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),this.canvas.width=this.zone.w,this.canvas.height=this.forceHeight?this.forceHeight:this.zone.h}draw(t){if(this.canvas===null)return;let s=this.zone.w,i=this.forceHeight?this.forceHeight:this.zone.h;u.toCanvas(this,s,i,t)}getDom(){return this.content}noMouse(){this.mouse.neg()}setMouse(t,s=!0){s?this.mouse.set(Math.round(t.x*this.canvas.width),this.canvas.height-Math.round(t.y*this.canvas.height)):this.mouse.set(Math.round(t.x*this.canvas.width),Math.round(t.y*this.canvas.height))}setConfig(t){a.setText(),this.colors=a.defineColor(t)}setColors(t){for(let s in t)this.colors[s]&&(this.colors[s]=t[s])}setText(t,s,i,h){a.setText(t,s,i,h)}hide(t){this.content.style.visibility=t?"hidden":"visible"}display(t=!1){this.content.style.visibility=t?"visible":"hidden"}onChange(t){return this.callback=t||null,this}mode(t){let s=!1,i=this.colors;if(t!==this.cn){switch(this.cn=t,t){case"def":u.cursor(),this.scroll.style.background=i.button,this.bottom.style.background=i.background,this.bottom.style.color=i.text;break;case"scrollOver":u.cursor("ns-resize"),this.scroll.style.background=i.select;break;case"scrollDown":this.scroll.style.background=i.select;break;case"bottomOver":u.cursor("pointer"),this.bottom.style.background=i.backgroundOver,this.bottom.style.color=i.textOver}s=!0}return s}clearTarget(){return this.current!==-1&&(this.proto.s&&(this.proto.uiout(),this.proto.reset()),this.proto=null,this.current=-1,u.cursor(),!0)}testZone(t){let s=this.local;if(s.x===-1&&s.y===-1)return"";this.isReset=!1;let i="",h=this.isScroll?this.zone.w-this.size.s:this.zone.w;return i=s.y>this.zone.h-this.bh&&s.y<this.zone.h?"bottom":s.x>h?"scroll":"content",i}handleEvent(t){let s=t.type,i=!1,h=!1,o=this.testZone(t);if(s==="mouseup"&&this.isDown&&(this.isDown=!1),s!=="mousedown"||this.isDown||(this.isDown=!0),this.isDown&&this.isNewTarget&&(u.clearInput(),this.isNewTarget=!1),o){switch(o){case"content":t.clientY=this.isScroll?t.clientY+this.decal:t.clientY,u.isMobile&&s==="mousedown"&&this.getNext(t,i),this.proto&&(h=this.proto.handleEvent(t)),s==="mousemove"&&(i=this.mode("def")),s==="wheel"&&!h&&this.isScroll&&(i=this.onWheel(t)),u.lock||this.getNext(t,i);break;case"bottom":this.clearTarget(),s==="mousemove"&&(i=this.mode("bottomOver")),s==="mousedown"&&(this.isOpen=!this.isOpen,this.bottom.textContent=this.isOpen?this.bottomText[1]:this.bottomText[0],this.calc(),this.mode("def"),i=!0);break;case"scroll":this.clearTarget(),s==="mousemove"&&(i=this.mode("scrollOver")),s==="mousedown"&&(i=this.mode("scrollDown")),s==="wheel"&&(i=this.onWheel(t)),this.isDown&&this.update(t.clientY-this.zone.y-.5*this.sh)}this.isDown&&(i=!0),h&&(i=!0),s==="keyup"&&(i=!0),s==="keydown"&&(i=!0),i&&this.draw()}}getNext(t,s){let i=u.findTarget(this.uis,t);i!==this.current&&(this.clearTarget(),this.current=i,this.isNewTarget=!0),i!==-1&&(this.proto=this.uis[this.current],this.proto.uiover())}onWheel(t){return this.oy+=20*t.delta,this.update(this.oy),!0}reset(t){if(this.isReset)return;this.mouse.neg(),this.isDown=!1;let s=this.mode("def"),i=this.clearTarget();(s||i)&&this.draw(!0),this.isReset=!0}add(){let t=arguments,s=!1;typeof t[1]=="object"?(t[1].isUI=!0,t[1].main=this,s=!!t[1].ontop&&t[1].ontop):typeof t[1]=="string"&&(t[2]===void 0?[].push.call(t,{isUI:!0,main:this}):(t[2].isUI=!0,t[2].main=this,s=!!t[2].ontop&&t[2].ontop));let i=O.apply(this,t);if(i!==null)return s?this.uis.unshift(i):this.uis.push(i),this.calc(),this.isEmpty=!1,i}remove(t){t.dispose&&t.dispose()}clearOne(t){let s=this.uis.indexOf(t);s!==-1&&(this.inner.removeChild(this.uis[s].c[0]),this.uis.splice(s,1),this.calc())}empty(){let t,s=this.uis.length;for(;s--;)t=this.uis.pop(),this.inner.removeChild(t.c[0]),t.dispose();this.uis=[],this.isEmpty=!0,this.calc()}clear(){this.empty()}clear2(){setTimeout(this.empty.bind(this),0)}dispose(){this.clear(),this.parent!==null&&this.parent.removeChild(this.content),u.remove(this)}resetItem(){if(!this.isItemMode)return;let t=this.uis.length;for(;t--;)this.uis[t].selected()}setItem(t){if(!this.isItemMode)return;if(t=t||"",this.resetItem(),!t)return void this.update(0);let s=this.uis.length;for(;s--;)this.uis[s].value===t&&(this.uis[s].selected(!0),this.isScroll&&this.update(s*(this.uis[s].h+this.margin)*this.ratio))}upScroll(t){this.sw=t?this.size.s:0,this.oy=t?this.oy:0,this.scrollBG.style.display=t?"block":"none",t&&(this.total=this.h,this.maxView=this.maxHeight,this.ratio=this.maxView/this.total,this.sh=this.maxView*this.ratio,this.range=this.maxView-this.sh,this.oy=a.clamp(this.oy,0,this.range),this.scrollBG.style.height=this.maxView+"px",this.scroll.style.height=this.sh+"px"),this.setItemWidth(this.zone.w-this.sw),this.update(this.oy)}update(t){t=a.clamp(t,0,this.range),this.decal=Math.floor(t/this.ratio),this.inner.style.top=-this.decal+"px",this.scroll.style.top=Math.floor(t)+"px",this.oy=t}calcUis(){return u.calcUis(this.uis,this.zone,this.zone.y)}calc(){clearTimeout(this.tmp),this.tmp=setTimeout(this.setHeight.bind(this),10)}setHeight(){if(this.tmp&&clearTimeout(this.tmp),this.zone.h=this.bh,this.isScroll=!1,this.isOpen){this.h=this.calcUis();let t=this.forceHeight?this.forceHeight+this.zone.y:window.innerHeight;this.maxHeight=t-this.zone.y-this.bh,this.h-this.maxHeight>1?(this.isScroll=!0,this.zone.h=this.maxHeight+this.bh):this.zone.h=this.h+this.bh}this.upScroll(this.isScroll),this.innerContent.style.height=this.zone.h-this.bh+"px",this.content.style.height=this.zone.h+"px",this.bottom.style.top=this.zone.h-this.bh+"px",this.forceHeight&&this.lockHeight&&(this.content.style.height=this.forceHeight+"px"),this.isCanvas&&this.draw(!0)}rezone(){u.needReZone=!0}setWidth(t){t&&(this.zone.w=t),this.zone.w=Math.floor(this.zone.w),this.content.style.width=this.zone.w+"px",this.isCenter&&(this.content.style.marginLeft=-Math.floor(.5*this.zone.w)+"px"),this.setItemWidth(this.zone.w-this.sw)}setItemWidth(t){let s=this.uis.length;for(;s--;)this.uis[s].setSize(t),this.uis[s].rSize()}}export{$ as D};
//# sourceMappingURL=uil.custom.module.js.map
